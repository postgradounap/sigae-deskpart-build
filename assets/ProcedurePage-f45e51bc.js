import{a as E,u as U,F as u,d as S,c as M,b as i,e as k,g as l,p as v,t as y,h as t,G as R,H as ce,i as x,w as a,f as n,I as q,J as N,K as B,L as be,M as ve,N as ye,k as I,m as C,o as J,j as Z,s as Q,v as oe,x as H,y as se,r as xe,O as le,P as ne,Q as ie,R as he,S as we,B as _e,T as Ve,U as $e,V as G,W as ke,X as Ce,Y as De,C as Pe,D as Te,_ as pe,A as Ue,Z as K,$ as Ee,n as Me,a0 as Re,a1 as Ae}from"./index-87bdaf6c.js";/* empty css                     *//* empty css                 *//* empty css                     */const Fe=async r=>{try{const{get_person_list:e}=E.routes.get().person,{data:o,status:s}=await U.post(e,{query:r});s==200&&u.personList.set(o)}catch(e){console.log(e)}};const Ne={class:"w-full text-sm p-2 flex flex-col items-center justify-center"},Se=l("i",{class:"fas fa-file-alt text-3xl"},null,-1),je={class:"text-xs"},qe=l("b",null,"Tramite",-1),Ie=l("div",{class:"w-full h-px bg-gray-300"},null,-1),Le={class:"p-2 flex flex-col gap-2"},ze=l("div",{class:"text-base text-blue-400 font-light"},"Datos del Tramite",-1),Oe={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Ye=l("i",{class:"fas fa-user"},null,-1),Be={class:"font-semibold"},Ge={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Ze=l("i",{class:"fas fa-calendar"},null,-1),He={class:"font-semibold"},Ke={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Je=l("i",{class:"fas fa-map-marker-alt"},null,-1),Qe={class:"font-semibold"},We={key:0,class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Xe=l("i",{class:"fa-sharp fa-solid fa-check"},null,-1),et=l("span",{class:"font-semibold bg-yellow-400 text-white rounded-lg px-2"},"Por confirmar aprobación",-1),tt=l("div",{class:"w-full border border-dotted"},null,-1),ot=l("div",{class:"text-base text-blue-400 font-light"},"Datos del Tramitante",-1),st={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},lt=l("i",{class:"fas fa-user"},null,-1),nt={class:"font-semibold"},at={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},rt=l("i",{class:"fas fa-file"},null,-1),ct={class:"font-semibold"},ut={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},dt=l("i",{class:"fas fa-file"},null,-1),it={class:"font-semibold"},_t={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},pt=l("i",{class:"fas fa-file"},null,-1),mt={class:"font-semibold"},ft=S({__name:"leftCard",setup(r){const e=M(()=>u.currentProcedure.get());return(o,s)=>{var c;return i(),k("div",null,[l("div",Ne,[Se,l("div",je,[qe,v(": "),l("span",null,y((c=t(e))==null?void 0:c.code_number),1)])]),Ie,l("div",Le,[ze,l("div",Oe,[Ye,v("Creado por: "),l("span",Be,y(t(e).user_name),1)]),l("div",Ge,[Ze,v("Fecha: "),l("span",He,y(t(e).created_at),1)]),l("div",Ke,[Je,v("Lugar de creación: "),l("span",Qe,y(t(e).headquarter_name),1)]),t(e).state?(i(),k("div",We,[Xe,v("Estado: "),et])):R("",!0),tt,ot,l("div",st,[lt,v("Tramitante: "),l("span",nt,y(t(e).person_full_name),1)]),l("div",at,[rt,v("Nro. Documento: "),l("span",ct,y(t(e).person_document),1)]),l("div",ut,[dt,v("Asunto: "),l("span",it,y(t(e).procedure_type_description),1)]),l("div",_t,[pt,v("Nro. Referencia: "),l("span",mt,y(t(e).reference_doc_number),1)])])])}}}),gt=async r=>{var e;try{const o=(e=E.routes.get().desk.procedures)==null?void 0:e.get_procedure_and_tracing_by_id;if(!o)return;const{data:s}=await U.post(o,{procedure_id:r});u.currentProcedure.set(s.procedure),u.procedureTracingList.set(s.procedure_tracings)}catch(o){console.log(o)}},bt={class:"flex justify-start gap-2 h-full"},vt={class:"items-center rounded-lg shadow-md w-[60%] h-96 p-2 timelineContent"},yt={class:"p-2 shadow rounded text-xs font-[roboto] border flex flex-col gap-2"},xt={class:"break-normal"},ht={class:"text-[10px]"},wt=S({__name:"procedureTimeline",setup(r){const e=M({get:()=>u.isOpenTimeline.get(),set:s=>u.isOpenTimeline.set(s)});ce(()=>e.value,s=>{s&&gt(u.currentProcedure.get().id)});const o=M(()=>u.procedureTracingList.get());return(s,c)=>{const _=ft,w=ye,$=be,f=ve;return i(),x(f,{modelValue:t(e),"onUpdate:modelValue":c[0]||(c[0]=d=>B(e)?e.value=d:null),"align-center":!0,class:"customDialog"},{default:a(()=>[l("div",bt,[n(_,{class:"w-[40%] flex flex-col gap-2"}),l("div",vt,[n($,null,{default:a(()=>[(i(!0),k(N,null,q(t(o),d=>(i(),x(w,{key:d.id,timestamp:d.date+" "+d.hour,placement:"top",color:"green"},{default:a(()=>[l("div",yt,[l("span",xt,y(d.action_log),1),l("b",ht,"Por: "+y(d.user),1)])]),_:2},1032,["timestamp"]))),128))]),_:1})])])]),_:1},8,["modelValue"])}}});const me=async()=>{try{const{get_areas:r}=E.routes.get().desk,{data:e,status:o}=await U.get(r);o==200&&u.areaList.set(e)}catch(r){console.log(r)}},Vt=()=>u.filters.get(),W=async()=>{var r;try{const e=(r=E.routes.get().desk.procedures)==null?void 0:r.get_procedures;if(!e)return;const{data:o}=await U.get(e,{params:Vt()});u.procedureList.set(o.procedures),u.procedureCounter.set(o.counters)}catch(e){console.log(e)}},$t=async r=>{try{const e=E.routes.get().desk.finally_trace_procedure,{status:o}=await U.post(e,r);o==200&&(I.success("Se Finalizo el Tramite correctamente"),W())}catch(e){console.log(e)}},kt=S({__name:"procedureFinish",setup(r){const e=C(!1),o=M(()=>u.currentProcedure.get()),s=C({action:"",assigned_user_id:0});J(async()=>{await me()});const c=()=>{u.isModalFinish.set(!1)},_=async()=>{var w;e.value=!0,o.value&&(s.value.procedure_id=o.value.id,Z.user.get()&&(s.value.user_id=(w=Z.user.get())==null?void 0:w.id)),e.value=!1,await $t(s.value),c()};return(w,$)=>{const f=Q,d=oe,p=H,g=se;return i(),x(g,{"label-position":"top",model:t(s)},{default:a(()=>[n(d,{label:"Acción"},{default:a(()=>[n(f,{type:"textarea",autosize:{minRows:4,maxRows:6},modelValue:t(s).action,"onUpdate:modelValue":$[0]||($[0]=P=>t(s).action=P)},null,8,["modelValue"])]),_:1}),n(d,{class:"flex mt-10 items-end"},{default:a(()=>[n(p,{loading:t(e),type:"primary",onClick:_},{default:a(()=>[v(y(t(o)?"Guardar":""),1)]),_:1},8,["loading"]),n(p,{onClick:c},{default:a(()=>[v("Cancel")]),_:1})]),_:1})]),_:1},8,["model"])}}});const Ct=async r=>{try{const{get_user_for_area:e}=E.routes.get().desk,{data:o,status:s}=await U.post(e,{area_id:r});s==200&&u.userAreaList.set(o)}catch(e){console.log(e)}},X=xe({tracingsForArea:[],tracingsForUser:[]}),te={get tracingsForArea(){return X.tracingsForArea},set tracingsForArea(r){X.tracingsForArea=r},get tracingsForUser(){return X.tracingsForUser},set tracingsForUser(r){X.tracingsForUser=r}},ue=async()=>{var r,e;try{const o=(r=E.routes.get().desk.procedure_tracing)==null?void 0:r.get_tracings_to_approved;if(!o){console.log("No se encontró la ruta para obtener los trámites pendientes");return}const s=((e=Z.user.get())==null?void 0:e.id)||0,{data:c}=await U.post(o,{user_id:s});te.tracingsForArea=c.tracings_for_area,te.tracingsForUser=c.tracings_for_user}catch(o){console.log(o)}},Dt=async r=>{try{const e=E.routes.get().desk.save_derive_procedure,{status:o,data:s}=await U.post(e,r);return o==200?(I.success("Se derivo el Tramite correctamente"),W(),ue(),!0):(I.error(`${s.message}`),!1)}catch(e){return console.log(e),!1}},Pt=S({__name:"procedureDerivation",setup(r){const e=C(!1),o=M(()=>u.currentProcedure.get()),s=M(()=>u.isModalDerivation.get()),c=C({action:"",assigned_user_id:0});J(async()=>{var f;c.value.number_of_sheets=(f=o.value)==null?void 0:f.number_of_sheets,await me()});const _=f=>{c.value.assigned_user_id=0,u.userAreaList.clear(),Ct(f)},w=()=>{u.isModalDerivation.set(!1),u.userAreaList.clear()},$=async()=>{var f;e.value=!0,o.value&&(c.value.procedure_id=o.value.id,Z.user.get()&&(c.value.user_id=(f=Z.user.get())==null?void 0:f.id)),e.value=!1,await Dt(c.value),w()};return ce(s,f=>{f||w()}),(f,d)=>{const p=le,g=ne,P=oe,F=Q,T=ie,m=H,b=se;return i(),x(b,{"label-position":"top",model:t(c)},{default:a(()=>[n(P,{label:"Oficina"},{default:a(()=>[n(g,{class:"w-full",placeholder:"Seleccione una oficina",modelValue:t(c).to_area_id,"onUpdate:modelValue":d[0]||(d[0]=D=>t(c).to_area_id=D),onChange:d[1]||(d[1]=D=>_(t(c).to_area_id))},{default:a(()=>[(i(!0),k(N,null,q(t(u).areaList.get(),D=>(i(),x(p,{key:D.id,label:D.nombre,value:D.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(P,{label:"Acción"},{default:a(()=>[n(F,{type:"textarea",autosize:{minRows:4,maxRows:6},modelValue:t(c).action,"onUpdate:modelValue":d[2]||(d[2]=D=>t(c).action=D)},null,8,["modelValue"])]),_:1}),n(P,{label:"Número de folios"},{default:a(()=>[n(T,{modelValue:t(c).number_of_sheets,"onUpdate:modelValue":d[3]||(d[3]=D=>t(c).number_of_sheets=D),min:0,max:100},null,8,["modelValue"])]),_:1}),n(P,{label:"Asignar Usuario"},{default:a(()=>[n(g,{class:"w-full",placeholder:"Seleccione Usuario",modelValue:t(c).assigned_user_id,"onUpdate:modelValue":d[4]||(d[4]=D=>t(c).assigned_user_id=D)},{default:a(()=>[(i(!0),k(N,null,q(t(u).userAreaList.get(),D=>(i(),x(p,{key:D.id,label:D.full_name,value:D.user_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(P,{class:"flex mt-10 items-end"},{default:a(()=>[n(m,{loading:t(e),type:"primary",onClick:$},{default:a(()=>[v(y(t(o)?"Derivar":""),1)]),_:1},8,["loading"]),n(m,{onClick:w},{default:a(()=>[v("Cancel")]),_:1})]),_:1})]),_:1},8,["model"])}}});const de={dni:"https://api.perudevs.com/api/v1/dni/simple?document=DOCUMENT_NUMBER&key=cGVydWRldnMucHJvZHVjdGlvbi5maXRjb2RlcnMuNjQ1Mjg1ZDA1MzAyNzA0ZDZmMmE1Njg2",ruc:"https://api.perudevs.com/api/v1/ruc?document=DOCUMENT_NUMBER&key=cGVydWRldnMucHJvZHVjdGlvbi5maXRjb2RlcnMuNjQ1Mjg1ZDA1MzAyNzA0ZDZmMmE1Njg2"},Tt=r=>{const e=r.nombres||r.nombre_comercial,o=r.apellido_paterno||r.razon_social,s=r.apellido_materno||"-",c=r.nombre_completo||r.razon_social;return{nombres:e,apellido_paterno:o,apellido_materno:s,full_name:c}},Ut=async(r,e="dni")=>{try{let o=de.dni;e!=="dni"&&(o=de.ruc),o=o.replace("DOCUMENT_NUMBER",r);const{data:s,status:c}=await U.get(o);if(c==200)return Tt(s.resultado)}catch(o){return console.log(o),null}},Et=async r=>{try{const e=E.routes.get().person.create,{data:o}=await U.post(e,r);return I.success("El registro se ha creado correctamente"),o}catch(e){return console.log(e),null}},Mt=[{id:1,name:"DNI"},{id:2,name:"RUC"},{id:3,name:"Pasaporte"},{id:4,name:"Carnet de Extranjería"}],Y="blur",Rt=(r,e,o)=>{e?e.length<8?o(new Error("El numero de documento debe tener al menos 8 digitos")):o():o(new Error("El numero de documento es requerido"))},At={tipo_documento:[{required:!0,message:"El tipo de documento es requerido",trigger:Y}],numero_documento:[{trigger:Y,validator:Rt}],nombres:[{required:!0,message:"El nombre es requerido",trigger:Y}],apellido_paterno:[{required:!0,message:"El apellido paterno es requerido",trigger:Y}],apellido_materno:[{required:!0,message:"El apellido materno es requerido",trigger:Y}],correo:[{required:!0,message:"Por favor ingrese un correo válido",type:"email",trigger:Y}],celular:[{required:!0,message:"El celular es requerido",trigger:Y}],sexo:[{required:!0,message:"El sexo es requerido",trigger:Y}],fecha_nacimiento:[{required:!0,message:"La fecha de nacimiento es requerida",trigger:Y}]},Ft={class:"flex flex-col gap-3 items-start"},Nt=l("i",{class:"fas fa-arrow-left mr-1"},null,-1),St=l("span",null,"Volver atrás",-1),jt=l("div",{class:"text-xs text-gray-400 text-center"}," Por favor ingrese valores en los campos (*) para registrar una nueva persona. ",-1),qt={class:"flex gap-2 items-center"},It={key:1},Lt={class:"flex flex-col md:flex-row"},zt=S({__name:"newPersonForm",emits:["create"],setup(r,{emit:e}){const o=C(),s=C({}),c=C(!1),_=C(null),w=async()=>{o.value.validate(async d=>{if(!d)return;if(_.value.name==="RUC"&&s.value.numero_documento.length!=11)return I.error("El tipo de documento RUC debe tener 11 dígitos");c.value=!0;const p=await Et(s.value);c.value=!1,p&&e("create",p)})};ce(_,()=>{_.value&&(s.value.tipo_documento=_.value.id)});const $=async()=>{var p;if(!s.value.numero_documento&&s.value.numero_documento.length<8||!_.value)return;const d=await Ut(s.value.numero_documento,(p=_.value)==null?void 0:p.name.toLocaleLowerCase());d&&(s.value.apellido_paterno=d.apellido_paterno,s.value.apellido_materno=d.apellido_materno,s.value.nombres=d.nombres,s.value.full_name=d.full_name)},f=()=>{s.value={},o.value.resetFields()};return(d,p)=>{const g=H,P=le,F=ne,T=oe,m=Q,b=he,D=we,L=_e,z=se;return i(),k("div",Ft,[n(g,{size:"small",link:"",onClick:p[0]||(p[0]=h=>d.$emit("return"))},{default:a(()=>[Nt,St]),_:1}),jt,n(z,{ref_key:"formPerson",ref:o,class:"w-full bg-gray-100 rounded-lg p-3","label-position":"top",model:t(s),rules:t(At)},{default:a(()=>[l("div",qt,[n(T,{label:"Tipo de Documento",prop:"tipo_documento",class:"w-full"},{default:a(()=>[n(F,{onChange:f,modelValue:t(_),"onUpdate:modelValue":p[1]||(p[1]=h=>B(_)?_.value=h:null),"value-key":"name",placeholder:"Seleccione un tipo de documento"},{default:a(()=>[(i(!0),k(N,null,q(t(Mt),(h,O)=>(i(),x(P,{key:O,label:h.name,value:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(T,{label:"Número de documento",prop:"numero_documento",class:"w-full"},{default:a(()=>[n(m,{type:"number",modelValue:t(s).numero_documento,"onUpdate:modelValue":p[2]||(p[2]=h=>t(s).numero_documento=h),onChange:$},null,8,["modelValue"])]),_:1})]),t(_)&&t(_).name==="RUC"?(i(),x(T,{key:0,label:"Nombre Completo",prop:"full_name"},{default:a(()=>[n(m,{modelValue:t(s).full_name,"onUpdate:modelValue":p[3]||(p[3]=h=>t(s).full_name=h),autocomplete:"off"},null,8,["modelValue"])]),_:1})):(i(),k("div",It,[n(T,{label:"Nombres",prop:"nombres"},{default:a(()=>[n(m,{modelValue:t(s).nombres,"onUpdate:modelValue":p[4]||(p[4]=h=>t(s).nombres=h),autocomplete:"off"},null,8,["modelValue"])]),_:1}),n(T,{label:"Apellido Paterno",prop:"apellido_paterno"},{default:a(()=>[n(m,{modelValue:t(s).apellido_paterno,"onUpdate:modelValue":p[5]||(p[5]=h=>t(s).apellido_paterno=h),autocomplete:"off"},null,8,["modelValue"])]),_:1}),n(T,{label:"Apellido Materno",prop:"apellido_materno"},{default:a(()=>[n(m,{modelValue:t(s).apellido_materno,"onUpdate:modelValue":p[6]||(p[6]=h=>t(s).apellido_materno=h),autocomplete:"off"},null,8,["modelValue"])]),_:1})])),n(T,{label:"Correo Electrónico",prop:"correo"},{default:a(()=>[n(m,{type:"email",modelValue:t(s).correo,"onUpdate:modelValue":p[7]||(p[7]=h=>t(s).correo=h),autocomplete:"off"},null,8,["modelValue"])]),_:1}),n(T,{label:"Celular",prop:"celular",class:"w-1/2"},{default:a(()=>[n(m,{type:"mobile",modelValue:t(s).celular,"onUpdate:modelValue":p[8]||(p[8]=h=>t(s).celular=h),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l("div",Lt,[n(T,{label:"Sexo",prop:"sexo",class:"w-full"},{default:a(()=>[n(D,{modelValue:t(s).sexo,"onUpdate:modelValue":p[9]||(p[9]=h=>t(s).sexo=h)},{default:a(()=>[n(b,{label:"M"},{default:a(()=>[v("Masculino")]),_:1}),n(b,{label:"F"},{default:a(()=>[v("Femenino")]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(T,{label:"Fecha de nacimiento",prop:"fecha_nacimiento",class:"w-full"},{default:a(()=>[n(L,{modelValue:t(s).fecha_nacimiento,"onUpdate:modelValue":p[10]||(p[10]=h=>t(s).fecha_nacimiento=h),type:"date",placeholder:"dia-mes-año",format:"DD-MM-YYYY","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),n(T,null,{default:a(()=>[n(g,{onClick:p[11]||(p[11]=h=>d.$emit("return"))},{default:a(()=>[v("Cancelar")]),_:1}),n(g,{loading:t(c),onClick:w,type:"primary"},{default:a(()=>[v("Crear registro")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])}}}),Ot=async()=>{try{const{procedure_type:r}=E.routes.get().desk,{data:e,status:o}=await U.get(r.get);o==200&&u.procedureTypeList.set(e)}catch(r){console.log(r)}},Yt=async r=>{var e;try{const o=(e=E.routes.get().desk.procedures)==null?void 0:e.save_procedure;if(!o)return;const{data:s,status:c}=await U.post(o,r);c==200&&(I.success(`Se creo el Documento con código:  ${s.code_number}`),W())}catch(o){console.log(o)}},Bt=async r=>{try{const{get_procedures_requirements:e}=E.routes.get().desk,{data:o,status:s}=await U.post(e,{procedure_type_id:r});s==200&&u.procedureRequirements.set(o)}catch(e){console.log(e)}},ee="blur",Gt={person_id:[{required:!0,message:"Por favor seleccione una persona",trigger:ee}],procedure_type_id:[{required:!0,message:"Por favor seleccione un tipo de procedimiento",trigger:ee}],subject:[{required:!0,message:"Por favor ingrese el asunto",trigger:ee},{min:5,message:"El asunto debe tener al menos 5 caracteres",trigger:ee}]},Zt=async r=>{var e;try{const o=(e=E.routes.get().desk.procedures)==null?void 0:e.update_procedure;if(!o)return I.error("No se encontró la ruta para actualizar el Documento"),!1;const s=await U.post(o,r);I.success(`Se actualizo el Documento con código:  ${s.data.code_number}`);let c=u.procedureList.get().find(_=>_.id===r.procedure_id);return c&&(c=Object.assign(c,{id:c.id,code_number:c.code_number,reference_doc_number:s.data.reference_doc_number,subject:s.data.subject,solicitante:c.solicitante,created_at:c.created_at,updated_at:c.updated_at})),!0}catch(o){return console.log(o),!1}},Ht={key:2,class:"w-full flex items-center justify-between pt-1"},Kt=l("div",null,null,-1),Jt=l("i",{class:"fas fa-plus ml-1 rounded-full"},null,-1),Qt=S({__name:"procedureForm",setup(r){const e=C({description:"",reference_doc_number:""}),o=C([]);C(!1);const s=C(),c=C(),_=M(()=>u.currentProcedure.get()),w=C(!1),$=C(!1),f=C(),d=async()=>{s.value.validate(async m=>{if(!m){I.error("Por favor, rellene los campos correctamente");return}e.value.user_id=Z.user.get().id,w.value=!0,_.value?await Zt({procedure_id:_.value.id,subject:_.value.subject,description:_.value.description,reference_doc_number:_.value.reference_doc_number,number_of_sheets:_.value.number_of_sheets}):await Yt(e.value),u.isModalOpen.set(!1),e.value={},w.value=!1})},p=m=>{Fe(m),o.value=u.personList.get()},g=()=>{u.isModalOpen.set(!1)},P=()=>{if(!_.value)return;e.value=_.value;const m=u.procedureTypeList.get().find(b=>b.id===_.value.procedure_type_id);m&&(e.value.procedure_type_id=m.id)},F=async()=>{e.value.procedure_type_id&&await Bt(e.value.procedure_type_id)},T=async m=>{$.value=!1,await p(m.numero_documento),e.value.person_id=m.id,f.value.focus()};return J(async()=>{s.value.resetFields(),u.procedureRequirements.set([]),await Ot(),P()}),(m,b)=>{const D=zt,L=le,z=H,h=ne,O=Q,j=oe,A=Ve,fe=ie,ge=se;return t($)?(i(),x(D,{key:0,onReturn:b[0]||(b[0]=V=>$.value=!1),onCreate:T})):(i(),x(ge,{key:1,class:"w-full bg-gray-100 rounded-lg p-3","label-position":"top",model:t(e),rules:t(Gt),"label-width":"120px",ref_key:"form",ref:s},{default:a(()=>[n(j,{label:"Solicitante",prop:"person_id"},{default:a(()=>[t(_)?(i(),x(O,{key:1,modelValue:t(e).person_full_name,"onUpdate:modelValue":b[2]||(b[2]=V=>t(e).person_full_name=V),disabled:""},null,8,["modelValue"])):(i(),x(h,{key:0,ref_key:"personIdRef",ref:c,modelValue:t(e).person_id,"onUpdate:modelValue":b[1]||(b[1]=V=>t(e).person_id=V),filterable:"",remote:"","reserve-keyword":"",placeholder:"Ingrese su numero de dni",class:"w-full","remote-method":p},{empty:a(()=>[n(L,{value:"",disabled:""},{default:a(()=>[v(" No se encontraron resultados - "),n(z,{link:""},{default:a(()=>[v("crear nuevo registro")]),_:1})]),_:1})]),default:a(()=>[(i(!0),k(N,null,q(t(o),V=>(i(),x(L,{key:V.id,label:V.full_name,value:V.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])),t(_)?R("",!0):(i(),k("div",Ht,[Kt,l("a",{onClick:b[3]||(b[3]=V=>$.value=!0),class:"text-xs text-blue-500 cursor-pointer"},[v(" Crear nuevo registro "),Jt])]))]),_:1}),n(j,{label:"Tramite",prop:"procedure_type_id"},{default:a(()=>[t(_)?(i(),x(O,{key:1,modelValue:t(e).procedure_type_description,"onUpdate:modelValue":b[5]||(b[5]=V=>t(e).procedure_type_description=V),disabled:""},null,8,["modelValue"])):(i(),x(h,{key:0,modelValue:t(e).procedure_type_id,"onUpdate:modelValue":b[4]||(b[4]=V=>t(e).procedure_type_id=V),class:"w-full",onChange:F,placeholder:"Seleccione un tramite",ref_key:"procedureTypeIdRef",ref:f},{default:a(()=>[(i(!0),k(N,null,q(t(u).procedureTypeList.get(),V=>(i(),x(L,{value:V.id,label:V.description},null,8,["value","label"]))),256))]),_:1},8,["modelValue"]))]),_:1}),t(u).procedureRequirements.get()&&t(u).procedureRequirements.get().length>0?(i(),x(j,{key:0,label:"Requisitos del tramite"},{default:a(()=>[(i(!0),k(N,null,q(t(u).procedureRequirements.get(),V=>(i(),x(A,{key:V.id,class:"mx-1",size:"small"},{default:a(()=>[v(y(V.description),1)]),_:2},1024))),128))]),_:1})):R("",!0),n(j,{label:"Asunto",prop:"subject"},{default:a(()=>[n(O,{type:"textarea",modelValue:t(e).subject,"onUpdate:modelValue":b[6]||(b[6]=V=>t(e).subject=V)},null,8,["modelValue"])]),_:1}),n(j,{label:"Observación"},{default:a(()=>[n(O,{modelValue:t(e).description,"onUpdate:modelValue":b[7]||(b[7]=V=>t(e).description=V),type:"textarea",autosize:{minRows:2,maxRows:4}},null,8,["modelValue"])]),_:1}),n(j,{label:"Referencia"},{default:a(()=>[n(O,{modelValue:t(e).reference_doc_number,"onUpdate:modelValue":b[8]||(b[8]=V=>t(e).reference_doc_number=V)},null,8,["modelValue"])]),_:1}),n(j,{label:"Número de folios"},{default:a(()=>[n(fe,{modelValue:t(e).number_of_sheets,"onUpdate:modelValue":b[9]||(b[9]=V=>t(e).number_of_sheets=V),min:0,max:100},null,8,["modelValue"])]),_:1}),n(j,{class:"flex items-center mt-10"},{default:a(()=>[n(z,{onClick:g},{default:a(()=>[v("Cancel")]),_:1}),n(z,{loading:t(w),type:"primary",onClick:d},{default:a(()=>[v(y(t(_)?"Actualizar Tramite":"Crear Tramite"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]))}}}),Wt={class:"my-header text-center mb-6"},Xt={class:"my-header text-center mb-6"},eo={class:"my-header text-center mb-6"},to=S({__name:"procedureDrawer",setup(r){const e=M(()=>u.currentProcedure.get()),o=M({get:()=>u.isModalOpen.get(),set:_=>u.isModalOpen.set(_)}),s=M({get:()=>u.isModalDerivation.get(),set:_=>u.isModalDerivation.set(_)}),c=M({get:()=>u.isModalFinish.get(),set:_=>u.isModalFinish.set(_)});return(_,w)=>{const $=Qt,f=$e,d=Pt,p=kt;return i(),k(N,null,[n(f,{modelValue:t(o),"onUpdate:modelValue":w[0]||(w[0]=g=>B(o)?o.value=g:null),class:"rounded-lg overflow-hidden customDrawer"},{header:a(()=>[l("div",Wt,[l("h1",null,y(t(e)?"Actualizar":"Nuevo")+" Tramite",1)])]),default:a(()=>[t(o)?(i(),x($,{key:0})):R("",!0)]),_:1},8,["modelValue"]),n(f,{modelValue:t(s),"onUpdate:modelValue":w[1]||(w[1]=g=>B(s)?s.value=g:null),class:"rounded-lg overflow-hidden"},{header:a(()=>[l("div",Xt,[l("h1",null,y(t(e)?"Derivar":"")+" Tramite N° "+y(t(e)?t(e).code_number:""),1)])]),default:a(()=>[t(s)?(i(),x(d,{key:0})):R("",!0)]),_:1},8,["modelValue"]),n(f,{modelValue:t(c),"onUpdate:modelValue":w[2]||(w[2]=g=>B(c)?c.value=g:null),class:"rounded-lg overflow-hidden"},{header:a(()=>[l("div",eo,[l("h1",null,y(t(e)?"Finalizar":"")+" Tramite N° "+y(t(e)?t(e).code_number:""),1)])]),default:a(()=>[t(c)?(i(),x(p,{key:0})):R("",!0)]),_:1},8,["modelValue"])],64)}}});const re=async r=>{var e;try{const o=(e=E.routes.get().desk.procedures)==null?void 0:e.get_procedure_by_id;if(!o){console.log("No se encontró la ruta para obtener el Documento");return}const s=o.replace("procedure_id",r.toString()),c=await U.get(s);u.currentProcedure.set(c.data)}catch(o){console.log(o)}},oo=async r=>{var e;try{const o=(e=E.routes.get().desk.procedures)==null?void 0:e.get_process_tracking_sheet_pdf;if(!o){console.error("route not found");return}const{data:s}=await U.get(o.replace("{procedure_id}",r.toString())),{path:c}=s;window.open(c,"_blank")}catch(o){console.error(o)}},ae=r=>(Pe("data-v-2ed411c5"),r=r(),Te(),r),so={class:"height-adapter overflow-auto"},lo={class:"truncate cursor-pointer underline text-blue-500"},no={class:"truncate"},ao={class:"truncate font-semibold"},ro=ae(()=>l("i",{class:"fa-solid fa-pen-to-square text-blue-500"},null,-1)),co=ae(()=>l("i",{class:"fa-sharp fa-solid fa-share-from-square text-blue-500"},null,-1)),uo=ae(()=>l("i",{class:"fa-sharp fa-regular fa-circle-xmark text-blue-500"},null,-1)),io=ae(()=>l("i",{class:"fa-solid fa-download text-blue-500"},null,-1)),_o=S({__name:"tableList",setup(r){const e=M(()=>u.tabSelected.get()),o=M(()=>u.procedureList.get()),s=d=>{u.currentProcedure.set(d),u.isOpenTimeline.set(!0)},c=async d=>{u.currentProcedure.set(d),await re(d.id),u.isModalOpen.set(!0)},_=(d,p)=>{u.currentProcedure.set(d);const g=p.getColumnIndex();d&&g==0&&s(d)},w=async d=>{u.currentProcedure.set(d),await re(d.id),u.isModalDerivation.set(!0)},$=async d=>{u.currentProcedure.set(d),await re(d.id),u.isModalFinish.set(!0)},f=async d=>{u.currentProcedure.set(d),await oo(d.id)};return(d,p)=>{const g=ke,P=Ce,F=H,T=De;return i(),k("div",so,[n(T,{data:t(o),onRowClick:_},{default:a(()=>[n(P,{prop:"code_number",label:"N° de tramite"},{default:a(({row:m})=>[n(g,{"popper-class":"text-lg",content:`Ver detalles del tramite ${m.code_number}`,placement:"top"},{default:a(()=>[l("div",lo,y(m.code_number),1)]),_:2},1032,["content"])]),_:1}),n(P,{prop:"solicitante",label:"Solicitante"}),n(P,{prop:"created_at",label:"Fecha de creación"}),n(P,{prop:"subject",label:"Asunto"},{default:a(({row:m})=>[l("div",no,y(m.subject),1)]),_:1}),n(P,{prop:"last_action",label:"Ultima acción"},{default:a(({row:m})=>[l("div",ao,y(m.last_action),1)]),_:1}),n(P,{label:"Acción",class:"w-full bg-red-500"},{default:a(({row:m})=>[t(e)===t(G).started?(i(),x(F,{key:0,size:"small",text:"",onClick:b=>c(m)},{default:a(()=>[n(g,{"popper-class":"text-lg",content:`Editar tramite ${m.code_number}`,placement:"top"},{default:a(()=>[ro]),_:2},1032,["content"])]),_:2},1032,["onClick"])):R("",!0),t(e)!==t(G).finished?(i(),x(F,{key:1,text:"",size:"small",onClick:b=>w(m),disabled:m.state},{default:a(()=>[n(g,{"popper-class":"text-lg",content:m.state?`Tramite ${m.code_number} pendiente de aprobación`:`Derivar tramite ${m.code_number}`,placement:"top"},{default:a(()=>[co]),_:2},1032,["content"])]),_:2},1032,["onClick","disabled"])):R("",!0),t(e)===t(G).in_progress?(i(),x(F,{key:2,size:"small",text:"",onClick:b=>$(m),disabled:m.state},{default:a(()=>[n(g,{"popper-class":"text-lg",content:m.state?`Tramite ${m.code_number} pendiente de aprobación`:`Finalizar tramite ${m.code_number}`,placement:"top"},{default:a(()=>[uo]),_:2},1032,["content"])]),_:2},1032,["onClick","disabled"])):R("",!0),n(F,{id:`loadingButton[${m}]`,size:"small",text:"",onClick:b=>f(m)},{default:a(()=>[n(g,{"popper-class":"text-lg",content:"Descargar PDF del tramite",placement:"top"},{default:a(()=>[io]),_:1})]),_:2},1032,["id","onClick"])]),_:1})]),_:1},8,["data"])])}}});const po=pe(_o,[["__scopeId","data-v-2ed411c5"]]);const mo=r=>{var e;return{tracing_id:r,user_id:(e=Z.user.get())==null?void 0:e.id}},fo=async r=>{var e;try{const o=(e=E.routes.get().desk.procedure_tracing)==null?void 0:e.approve_tracing;if(!o)return;await U.post(o,mo(r)),ue(),W(),I.success("Aprobaste la asignación del documento")}catch(o){console.log(o)}},go={class:"w-full p-2 bg-gray-100 rounded flex flex-col"},bo={class:"flex items-center gap-2"},vo={class:"text-[10px]"},yo={class:"flex"},xo=l("div",{class:"w-5"},null,-1),ho=S({__name:"pendingCard",props:{cardItem:{type:Object,required:!0}},setup(r){const e=r,o=C(!1),s=M(()=>{const _=e.cardItem.user.split(" ");return`${_[0].charAt(0)}${_[_.length-1].charAt(0)}`}),c=async()=>{o.value=!0,await fo(e.cardItem.id),o.value=!1};return(_,w)=>{const $=Ue,f=H;return i(),k("div",go,[l("div",bo,[l("div",null,[r.cardItem.image?(i(),x($,{key:0,size:"small",src:r.cardItem.image},null,8,["src"])):(i(),x($,{key:1,size:"small"},{default:a(()=>[v(y(t(s)),1)]),_:1}))]),l("div",vo,[l("b",null,y(r.cardItem.user),1),v(" te a asignado un documento el dia "+y(r.cardItem.date)+" a las "+y(r.cardItem.hour),1)])]),l("div",yo,[xo,l("b",null,[n(f,{onClick:c,loading:t(o),text:"",size:"small",class:"text-blue-500"},{default:a(()=>[v("Aprobar")]),_:1},8,["loading"])])])])}}}),wo={key:0,class:"flex mt-3 bg-yellow-50 p-2 rounded shadow-sm items-center justify-center gap-5 break-normal"},Vo=l("i",{class:"fas fa-exclamation-triangle text-2xl text-yellow-500"},null,-1),$o=l("div",{class:"flex flex-col gap-2"},[l("h1",{class:"font-semibold"},"¡Estos documentos necesitan de tu atención! 😎"),l("span",{class:"text-xs text-gray-500"}," Aquí se muestran los documentos asignados a ti ó al area donde trabajas, que aún no han sido aprobados. ")],-1),ko=[Vo,$o],Co=l("i",{class:"fas fa-user text-gray-500"},null,-1),Do={key:0},Po={key:0,class:"mt-2 w-full cardContent epgScroll"},To={class:"flex flex-col"},Uo={class:"flex flex-col mt-5"},Eo=l("i",{class:"fas fa-users text-gray-500"},null,-1),Mo={key:0},Ro={key:0,class:"mt-2 w-full cardContent epgScroll"},Ao={class:"flex flex-col"},Fo=S({__name:"pendingComponent",setup(r){const e=M(()=>te.tracingsForUser),o=M(()=>te.tracingsForArea),s=C(!0),c=C(!1);return J(async()=>{await ue(),c.value=!0}),(_,w)=>{const $=ho,f=Ee;return i(),k("div",{class:K(["h-full relative pending",t(s)?"is-open":"is-closed"])},[t(s)?(i(),k("div",wo,ko)):R("",!0),l("div",{class:K(["flex flex-col",t(s)?"mt-4":"mt-10"])},[l("h1",{class:K(["text-xs text-gray-500 flex gap-2 items-center",{"flex flex-col ":!t(s)}])},[Co,t(s)?(i(),k("span",Do,"Documentos asignados a ti")):R("",!0),l("span",{class:K(["text-xs px-2 bg-yellow-500 text-white rounded-full",{" animate-pulse":!t(s)&&t(e).length>0}])},y(t(e).length),3)],2),t(s)?(i(),k("div",Po,[l("div",To,[(i(!0),k(N,null,q(t(e),(d,p)=>(i(),x($,{class:"border-b border-white",key:p,"card-item":d},null,8,["card-item"]))),128))])])):R("",!0)],2),n(f),l("div",Uo,[l("h1",{class:K(["text-xs text-gray-500 flex items-center gap-2",{"flex flex-col ":!t(s)}])},[Eo,t(s)?(i(),k("span",Mo,"Documentos asignados a tu área")):R("",!0),l("span",{class:K(["text-xs px-2 bg-yellow-500 text-white rounded-full",{" animate-pulse":!t(s)&&t(e).length>0}])},y(t(o).length),3)],2),t(s)?(i(),k("div",Ro,[l("div",Ao,[(i(!0),k(N,null,q(t(o),(d,p)=>(i(),x($,{class:"border-b border-white",key:p,"card-item":d},null,8,["card-item"]))),128))])])):R("",!0)])],2)}}});const No=async()=>{try{const r=E.routes.get().desk.years_for_procedures,{data:e}=await U.get(r);u.yearsProcedures.set(e)}catch(r){console.log(r)}},So={class:"flex justify-between gap-2 w-full h-full"},jo={class:"w-max-[350px]"},qo={class:"w-full bg-white shadow-md rounded-lg p-5 flex flex-col gap-5"},Io=l("section",null,[l("p",{class:"text-3xl font-bold"},"Tramites")],-1),Lo={class:"flex flex-col gap-3"},zo={class:"flex items-center justify-between"},Oo={class:"flex items-center gap-2"},Yo={class:"flex"},Bo=l("div",{class:"flex gap-2"},[l("i",{class:"fa-sharp fa-solid fa-search"}),v(" Buscar")],-1),Go={class:"flex"},Zo=l("div",{class:"flex gap-2"},[l("i",{class:"fa-sharp fa-solid fa-plus"}),v(" Nuevo tramite")],-1),Ho={class:"inline-flex items-center justify-center px-2 py-1 mr-2 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full"},Ko={class:"inline-flex items-center justify-center px-2 py-1 mr-2 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full"},Jo={class:"inline-flex items-center justify-center px-2 py-1 mr-2 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full"},Qo=S({__name:"index",setup(r){const e=C(G.started),o=C(""),s=C(""),c=C([]),_=C(""),w=()=>{u.currentProcedure.set(null),u.isModalOpen.set(!0)},$=()=>{f()},f=async()=>{let p=`${s.value}-${_.value}`;s.value||(p=null),u.filters.set({date:o.value,code_number:p||"",state:e.value}),u.tabSelected.set(e.value),await W()},d=()=>{f()};return J(async()=>{No(),c.value=u.yearsProcedures.get(),_.value=new Date().getFullYear().toString(),f()}),(p,g)=>{const P=Fo,F=_e,T=le,m=ne,b=Q,D=H,L=po,z=Ae,h=Re,O=to,j=wt;return i(),k(N,null,[l("div",So,[l("div",jo,[n(P,{class:"bg-white rounded-lg shadow-md p-5"})]),l("div",qo,[Io,l("div",Lo,[l("div",zo,[l("div",Oo,[n(F,{modelValue:t(o),"onUpdate:modelValue":g[0]||(g[0]=A=>B(o)?o.value=A:null),type:"date",placeholder:"Selecciona una fecha",onChange:f,format:"DD/MM/YYYY","value-format":"YYYY-MM-DD"},null,8,["modelValue"]),l("div",Yo,[n(m,{modelValue:t(_),"onUpdate:modelValue":g[1]||(g[1]=A=>B(_)?_.value=A:null),placeholder:"Periodo",onChange:f},{default:a(()=>[(i(!0),k(N,null,q(t(c),A=>(i(),x(T,{key:A,label:A,value:A},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(b,{onInput:d,onKeydown:Me(f,["enter"]),modelValue:t(s),"onUpdate:modelValue":g[2]||(g[2]=A=>B(s)?s.value=A:null),placeholder:"N° de tramite"},null,8,["onKeydown","modelValue"])]),n(D,{type:"primary",onClick:f},{default:a(()=>[Bo]),_:1})]),l("div",Go,[n(D,{type:"primary",onClick:w},{default:a(()=>[Zo]),_:1})])]),n(h,{modelValue:t(e),"onUpdate:modelValue":g[3]||(g[3]=A=>B(e)?e.value=A:null),onTabChange:$},{default:a(()=>[n(z,{name:t(G).started},{label:a(()=>[l("span",null,[v("Iniciados "),l("div",Ho,y(t(u).procedureCounter.get().started.label),1)])]),default:a(()=>[n(L)]),_:1},8,["name"]),n(z,{name:t(G).in_progress},{label:a(()=>[l("span",null,[v("En proceso "),l("div",Ko,y(t(u).procedureCounter.get().in_progress.label),1)])]),default:a(()=>[n(L)]),_:1},8,["name"]),n(z,{name:t(G).finished},{label:a(()=>[l("span",null,[v("Finalizados "),l("div",Jo,y(t(u).procedureCounter.get().finished.label),1)])]),default:a(()=>[n(L)]),_:1},8,["name"])]),_:1},8,["modelValue"])])])]),n(O),n(j)],64)}}}),Wo={};function Xo(r,e){const o=Qo;return i(),x(o)}const ls=pe(Wo,[["render",Xo]]);export{ls as default};
