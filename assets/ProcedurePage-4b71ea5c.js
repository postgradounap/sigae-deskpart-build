import{d as S,c as M,F as u,b as i,e as $,g as l,p as y,t as x,h as t,G as A,a as R,u as E,H as ce,i as w,w as n,f as a,I as N,J as j,K as z,L as ve,M as ye,N as xe,k as q,m as C,o as J,j as Z,s as Q,v as oe,x as G,y as se,r as he,O as le,P as ae,Q as ie,R as we,S as Ve,B as _e,T as $e,U as ke,V as Ce,W as B,X as De,Y as Pe,Z as Te,C as Ue,D as Ee,_ as pe,A as Me,$ as K,a0 as Re,n as Ae,a1 as Fe,a2 as Ne}from"./index-cc402cb0.js";/* empty css                *//* empty css                       */const Se={class:"w-full text-sm p-2 flex flex-col items-center justify-center"},je=l("i",{class:"fas fa-file-alt text-3xl"},null,-1),qe={class:"text-xs"},Ie=l("b",null,"Tramite",-1),Le=l("div",{class:"w-full h-px bg-gray-300"},null,-1),ze={class:"p-2 flex flex-col gap-2"},Oe=l("div",{class:"text-base text-blue-400 font-light"},"Datos del Tramite",-1),Ye={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Be=l("i",{class:"fas fa-user"},null,-1),Ze={class:"font-semibold"},Ge={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},He=l("i",{class:"fas fa-calendar"},null,-1),Ke={class:"font-semibold"},Je={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Qe=l("i",{class:"fas fa-map-marker-alt"},null,-1),We={class:"font-semibold"},Xe={key:0,class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},et=l("i",{class:"fa-sharp fa-solid fa-check"},null,-1),tt=l("span",{class:"font-semibold bg-yellow-400 text-white rounded-lg px-2"},"Por confirmar aprobación",-1),ot=l("div",{class:"w-full border border-dotted"},null,-1),st=l("div",{class:"text-base text-blue-400 font-light"},"Datos del Tramitante",-1),lt={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},at=l("i",{class:"fas fa-user"},null,-1),nt={class:"font-semibold"},rt={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},ct=l("i",{class:"fas fa-file"},null,-1),ut={class:"font-semibold"},dt={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},it=l("i",{class:"fas fa-file"},null,-1),_t={class:"font-semibold"},pt={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},mt=l("i",{class:"fas fa-file"},null,-1),ft={class:"font-semibold"},gt=S({__name:"leftCard",setup(r){const e=M(()=>u.currentProcedure.get());return(o,s)=>{var c;return i(),$("div",null,[l("div",Se,[je,l("div",qe,[Ie,y(": "),l("span",null,x((c=t(e))==null?void 0:c.code_number),1)])]),Le,l("div",ze,[Oe,l("div",Ye,[Be,y("Creado por: "),l("span",Ze,x(t(e).user_name),1)]),l("div",Ge,[He,y("Fecha: "),l("span",Ke,x(t(e).created_at),1)]),l("div",Je,[Qe,y("Lugar de creación: "),l("span",We,x(t(e).headquarter_name),1)]),t(e).state?(i(),$("div",Xe,[et,y("Estado: "),tt])):A("",!0),ot,st,l("div",lt,[at,y("Tramitante: "),l("span",nt,x(t(e).person_full_name),1)]),l("div",rt,[ct,y("Nro. Documento: "),l("span",ut,x(t(e).person_document),1)]),l("div",dt,[it,y("Asunto: "),l("span",_t,x(t(e).procedure_type_description),1)]),l("div",pt,[mt,y("Nro. Referencia: "),l("span",ft,x(t(e).reference_doc_number),1)])])])}}}),bt=async r=>{var e;try{const o=(e=R.routes.get().desk.procedures)==null?void 0:e.get_procedure_and_tracing_by_id;if(!o)return;const{data:s}=await E.post(o,{procedure_id:r});u.currentProcedure.set(s.procedure),u.procedureTracingList.set(s.procedure_tracings)}catch(o){console.log(o)}},vt={class:"flex justify-start gap-2 h-full"},yt={class:"items-center rounded-lg shadow-md w-[60%] h-96 p-2 timelineContent"},xt={class:"p-2 shadow rounded text-xs font-[roboto] border flex flex-col gap-2"},ht={class:"break-normal"},wt={class:"text-[10px]"},Vt=S({__name:"procedureTimeline",setup(r){const e=M({get:()=>u.isOpenTimeline.get(),set:s=>u.isOpenTimeline.set(s)});ce(()=>e.value,s=>{s&&bt(u.currentProcedure.get().id)});const o=M(()=>u.procedureTracingList.get());return(s,c)=>{const m=gt,g=ve,k=ye,f=xe;return i(),w(f,{modelValue:t(e),"onUpdate:modelValue":c[0]||(c[0]=d=>z(e)?e.value=d:null),"align-center":!0,class:"customDialog"},{default:n(()=>[l("div",vt,[a(m,{class:"w-[40%] flex flex-col gap-2"}),l("div",yt,[a(k,null,{default:n(()=>[(i(!0),$(N,null,j(t(o),d=>(i(),w(g,{key:d.id,timestamp:d.date+" "+d.hour,placement:"top",color:"green"},{default:n(()=>[l("div",xt,[l("span",ht,x(d.action_log),1),l("b",wt,"Por: "+x(d.user),1)])]),_:2},1032,["timestamp"]))),128))]),_:1})])])]),_:1},8,["modelValue"])}}});const me=async()=>{try{const{get_areas:r}=R.routes.get().desk,{data:e,status:o}=await E.get(r);o==200&&u.areaList.set(e)}catch(r){console.log(r)}},$t=()=>u.filters.get(),W=async()=>{var r;try{const e=(r=R.routes.get().desk.procedures)==null?void 0:r.get_procedures;if(!e)return;const{data:o}=await E.get(e,{params:$t()});u.procedureList.set(o.procedures),u.procedureCounter.set(o.counters)}catch(e){console.log(e)}},kt=async r=>{try{const e=R.routes.get().desk.finally_trace_procedure,{status:o}=await E.post(e,r);o==200&&(q.success("Se Finalizo el Tramite correctamente"),W())}catch(e){console.log(e)}},Ct=S({__name:"procedureFinish",setup(r){const e=C(!1),o=M(()=>u.currentProcedure.get()),s=C({action:"",assigned_user_id:0});J(async()=>{await me()});const c=()=>{u.isModalFinish.set(!1)},m=async()=>{var g;e.value=!0,o.value&&(s.value.procedure_id=o.value.id,Z.user.get()&&(s.value.user_id=(g=Z.user.get())==null?void 0:g.id)),e.value=!1,await kt(s.value),c()};return(g,k)=>{const f=Q,d=oe,_=G,v=se;return i(),w(v,{"label-position":"top",model:t(s)},{default:n(()=>[a(d,{label:"Acción"},{default:n(()=>[a(f,{type:"textarea",autosize:{minRows:4,maxRows:6},modelValue:t(s).action,"onUpdate:modelValue":k[0]||(k[0]=P=>t(s).action=P)},null,8,["modelValue"])]),_:1}),a(d,{class:"flex mt-10 items-end"},{default:n(()=>[a(_,{loading:t(e),type:"primary",onClick:m},{default:n(()=>[y(x(t(o)?"Guardar":""),1)]),_:1},8,["loading"]),a(_,{onClick:c},{default:n(()=>[y("Cancel")]),_:1})]),_:1})]),_:1},8,["model"])}}});const Dt=async r=>{try{const{get_user_for_area:e}=R.routes.get().desk,{data:o,status:s}=await E.post(e,{area_id:r});s==200&&u.userAreaList.set(o)}catch(e){console.log(e)}},X=he({tracingsForArea:[],tracingsForUser:[]}),te={get tracingsForArea(){return X.tracingsForArea},set tracingsForArea(r){X.tracingsForArea=r},get tracingsForUser(){return X.tracingsForUser},set tracingsForUser(r){X.tracingsForUser=r}},ue=async()=>{var r,e;try{const o=(r=R.routes.get().desk.procedure_tracing)==null?void 0:r.get_tracings_to_approved;if(!o){console.log("No se encontró la ruta para obtener los trámites pendientes");return}const s=((e=Z.user.get())==null?void 0:e.id)||0,{data:c}=await E.post(o,{user_id:s});te.tracingsForArea=c.tracings_for_area,te.tracingsForUser=c.tracings_for_user}catch(o){console.log(o)}},Pt=async r=>{try{const e=R.routes.get().desk.save_derive_procedure,{status:o,data:s}=await E.post(e,r);return o==200?(q.success("Se derivo el Tramite correctamente"),W(),ue(),!0):(q.error(`${s.message}`),!1)}catch(e){return console.log(e),!1}},Tt=S({__name:"procedureDerivation",setup(r){const e=C(!1),o=M(()=>u.currentProcedure.get()),s=M(()=>u.isModalDerivation.get()),c=C({action:"",assigned_user_id:0});J(async()=>{var f;c.value.number_of_sheets=(f=o.value)==null?void 0:f.number_of_sheets,await me()});const m=f=>{c.value.assigned_user_id=0,u.userAreaList.clear(),Dt(f)},g=()=>{u.isModalDerivation.set(!1),u.userAreaList.clear()},k=async()=>{var f;e.value=!0,o.value&&(c.value.procedure_id=o.value.id,Z.user.get()&&(c.value.user_id=(f=Z.user.get())==null?void 0:f.id)),e.value=!1,await Pt(c.value),g()};return ce(s,f=>{f||g()}),(f,d)=>{const _=le,v=ae,P=oe,F=Q,U=ie,b=G,D=se;return i(),w(D,{"label-position":"top",model:t(c)},{default:n(()=>[a(P,{label:"Oficina"},{default:n(()=>[a(v,{class:"w-full",placeholder:"Seleccione una oficina",modelValue:t(c).to_area_id,"onUpdate:modelValue":d[0]||(d[0]=p=>t(c).to_area_id=p),onChange:d[1]||(d[1]=p=>m(t(c).to_area_id))},{default:n(()=>[(i(!0),$(N,null,j(t(u).areaList.get(),p=>(i(),w(_,{key:p.id,label:p.nombre,value:p.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(P,{label:"Acción"},{default:n(()=>[a(F,{type:"textarea",autosize:{minRows:4,maxRows:6},modelValue:t(c).action,"onUpdate:modelValue":d[2]||(d[2]=p=>t(c).action=p)},null,8,["modelValue"])]),_:1}),a(P,{label:"Número de folios"},{default:n(()=>[a(U,{modelValue:t(c).number_of_sheets,"onUpdate:modelValue":d[3]||(d[3]=p=>t(c).number_of_sheets=p),min:0,max:100},null,8,["modelValue"])]),_:1}),a(P,{label:"Asignar Usuario"},{default:n(()=>[a(v,{class:"w-full",placeholder:"Seleccione Usuario",modelValue:t(c).assigned_user_id,"onUpdate:modelValue":d[4]||(d[4]=p=>t(c).assigned_user_id=p)},{default:n(()=>[(i(!0),$(N,null,j(t(u).userAreaList.get(),p=>(i(),w(_,{key:p.id,label:p.full_name,value:p.user_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(P,{class:"flex mt-10 items-end"},{default:n(()=>[a(b,{loading:t(e),type:"primary",onClick:k},{default:n(()=>[y(x(t(o)?"Derivar":""),1)]),_:1},8,["loading"]),a(b,{onClick:g},{default:n(()=>[y("Cancel")]),_:1})]),_:1})]),_:1},8,["model"])}}});const de={dni:"https://api.perudevs.com/api/v1/dni/simple?document=DOCUMENT_NUMBER&key=cGVydWRldnMucHJvZHVjdGlvbi5maXRjb2RlcnMuNjQ1Mjg1ZDA1MzAyNzA0ZDZmMmE1Njg2",ruc:"https://api.perudevs.com/api/v1/ruc?document=DOCUMENT_NUMBER&key=cGVydWRldnMucHJvZHVjdGlvbi5maXRjb2RlcnMuNjQ1Mjg1ZDA1MzAyNzA0ZDZmMmE1Njg2"},Ut=r=>{const e=r.nombres||r.nombre_comercial,o=r.apellido_paterno||r.razon_social,s=r.apellido_materno||"-",c=r.nombre_completo||r.razon_social;return{nombres:e,apellido_paterno:o,apellido_materno:s,full_name:c}},Et=async(r,e="dni")=>{try{let o=de.dni;e!=="dni"&&(o=de.ruc),o=o.replace("DOCUMENT_NUMBER",r);const{data:s,status:c}=await E.get(o);if(c==200)return Ut(s.resultado)}catch(o){return console.log(o),null}},Mt=async r=>{try{const e=R.routes.get().person.create,{data:o}=await E.post(e,r);return q.success("El registro se ha creado correctamente"),o}catch(e){return console.log(e),null}},Rt=[{id:1,name:"DNI"},{id:2,name:"RUC"},{id:3,name:"Pasaporte"},{id:4,name:"Carnet de Extranjería"}],L="blur",At=(r,e,o)=>{e?e.length<8?o(new Error("El numero de documento debe tener al menos 8 digitos")):o():o(new Error("El numero de documento es requerido"))},Ft={tipo_documento:[{required:!0,message:"El tipo de documento es requerido",trigger:L}],numero_documento:[{trigger:L,validator:At}],nombres:[{required:!0,message:"El nombre es requerido",trigger:L}],apellido_paterno:[{required:!0,message:"El apellido paterno es requerido",trigger:L}],apellido_materno:[{required:!0,message:"El apellido materno es requerido",trigger:L}],correo:[{required:!0,message:"Por favor ingrese un correo válido",type:"email",trigger:L}],celular:[{required:!0,message:"El celular es requerido",trigger:L}],sexo:[{required:!0,message:"El sexo es requerido",trigger:L}],fecha_nacimiento:[{required:!0,message:"La fecha de nacimiento es requerida",trigger:L}]},Nt={class:"flex flex-col gap-3 items-start"},St=l("i",{class:"fas fa-arrow-left mr-1"},null,-1),jt=l("span",null,"Volver atrás",-1),qt=l("div",{class:"text-xs text-gray-400 text-center"}," Por favor ingrese valores en los campos (*) para registrar una nueva persona. ",-1),It={class:"flex gap-2 items-center"},Lt={key:1},zt={class:"flex flex-col md:flex-row"},Ot=S({__name:"newPersonForm",emits:["create"],setup(r,{emit:e}){const o=C(),s=C({}),c=C(!1),m=C(null),g=async()=>{o.value.validate(async d=>{if(!d)return;if(m.value.name==="RUC"&&s.value.numero_documento.length!=11)return q.error("El tipo de documento RUC debe tener 11 dígitos");c.value=!0;const _=await Mt(s.value);c.value=!1,_&&e("create",_)})};ce(m,()=>{m.value&&(s.value.tipo_documento=m.value.id)});const k=async()=>{var _;if(!s.value.numero_documento&&s.value.numero_documento.length<8||!m.value)return;const d=await Et(s.value.numero_documento,(_=m.value)==null?void 0:_.name.toLocaleLowerCase());d&&(s.value.apellido_paterno=d.apellido_paterno,s.value.apellido_materno=d.apellido_materno,s.value.nombres=d.nombres,s.value.full_name=d.full_name)},f=()=>{s.value={},o.value.resetFields()};return(d,_)=>{const v=G,P=le,F=ae,U=oe,b=Q,D=we,p=Ve,O=_e,I=se;return i(),$("div",Nt,[a(v,{size:"small",link:"",onClick:_[0]||(_[0]=h=>d.$emit("return"))},{default:n(()=>[St,jt]),_:1}),qt,a(I,{ref_key:"formPerson",ref:o,class:"w-full bg-gray-100 rounded-lg p-3","label-position":"top",model:t(s),rules:t(Ft)},{default:n(()=>[l("div",It,[a(U,{label:"Tipo de Documento",prop:"tipo_documento",class:"w-full"},{default:n(()=>[a(F,{onChange:f,modelValue:t(m),"onUpdate:modelValue":_[1]||(_[1]=h=>z(m)?m.value=h:null),"value-key":"name",placeholder:"Seleccione un tipo de documento"},{default:n(()=>[(i(!0),$(N,null,j(t(Rt),(h,H)=>(i(),w(P,{key:H,label:h.name,value:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(U,{label:"Número de documento",prop:"numero_documento",class:"w-full"},{default:n(()=>[a(b,{type:"number",modelValue:t(s).numero_documento,"onUpdate:modelValue":_[2]||(_[2]=h=>t(s).numero_documento=h),onChange:k},null,8,["modelValue"])]),_:1})]),t(m)&&t(m).name==="RUC"?(i(),w(U,{key:0,label:"Nombre Completo",prop:"full_name"},{default:n(()=>[a(b,{modelValue:t(s).full_name,"onUpdate:modelValue":_[3]||(_[3]=h=>t(s).full_name=h),autocomplete:"off"},null,8,["modelValue"])]),_:1})):(i(),$("div",Lt,[a(U,{label:"Nombres",prop:"nombres"},{default:n(()=>[a(b,{modelValue:t(s).nombres,"onUpdate:modelValue":_[4]||(_[4]=h=>t(s).nombres=h),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(U,{label:"Apellido Paterno",prop:"apellido_paterno"},{default:n(()=>[a(b,{modelValue:t(s).apellido_paterno,"onUpdate:modelValue":_[5]||(_[5]=h=>t(s).apellido_paterno=h),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(U,{label:"Apellido Materno",prop:"apellido_materno"},{default:n(()=>[a(b,{modelValue:t(s).apellido_materno,"onUpdate:modelValue":_[6]||(_[6]=h=>t(s).apellido_materno=h),autocomplete:"off"},null,8,["modelValue"])]),_:1})])),a(U,{label:"Correo Electrónico",prop:"correo"},{default:n(()=>[a(b,{type:"email",modelValue:t(s).correo,"onUpdate:modelValue":_[7]||(_[7]=h=>t(s).correo=h),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(U,{label:"Celular",prop:"celular",class:"w-1/2"},{default:n(()=>[a(b,{type:"mobile",modelValue:t(s).celular,"onUpdate:modelValue":_[8]||(_[8]=h=>t(s).celular=h),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l("div",zt,[a(U,{label:"Sexo",prop:"sexo",class:"w-full"},{default:n(()=>[a(p,{modelValue:t(s).sexo,"onUpdate:modelValue":_[9]||(_[9]=h=>t(s).sexo=h)},{default:n(()=>[a(D,{label:"M"},{default:n(()=>[y("Masculino")]),_:1}),a(D,{label:"F"},{default:n(()=>[y("Femenino")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(U,{label:"Fecha de nacimiento",prop:"fecha_nacimiento",class:"w-full"},{default:n(()=>[a(O,{modelValue:t(s).fecha_nacimiento,"onUpdate:modelValue":_[10]||(_[10]=h=>t(s).fecha_nacimiento=h),type:"date",placeholder:"dia-mes-año",format:"DD-MM-YYYY","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),a(U,null,{default:n(()=>[a(v,{onClick:_[11]||(_[11]=h=>d.$emit("return"))},{default:n(()=>[y("Cancelar")]),_:1}),a(v,{loading:t(c),onClick:g,type:"primary"},{default:n(()=>[y("Crear registro")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])}}}),Yt=async()=>{try{const{procedure_type:r}=R.routes.get().desk,{data:e,status:o}=await E.get(r.get);o==200&&u.procedureTypeList.set(e)}catch(r){console.log(r)}},Bt=async r=>{var e;try{const o=(e=R.routes.get().desk.procedures)==null?void 0:e.save_procedure;if(!o)return;const{data:s,status:c}=await E.post(o,r);c==200&&(q.success(`Se creo el Documento con código:  ${s.code_number}`),W())}catch(o){console.log(o)}},Zt=async r=>{try{const{get_procedures_requirements:e}=R.routes.get().desk,{data:o,status:s}=await E.post(e,{procedure_type_id:r});s==200&&u.procedureRequirements.set(o)}catch(e){console.log(e)}},ee="blur",Gt={person_id:[{required:!0,message:"Por favor seleccione una persona",trigger:ee}],procedure_type_id:[{required:!0,message:"Por favor seleccione un tipo de procedimiento",trigger:ee}],subject:[{required:!0,message:"Por favor ingrese el asunto",trigger:ee},{min:5,message:"El asunto debe tener al menos 5 caracteres",trigger:ee}]},Ht=async r=>{var e;try{const o=(e=R.routes.get().desk.procedures)==null?void 0:e.update_procedure;if(!o)return q.error("No se encontró la ruta para actualizar el Documento"),!1;const s=await E.post(o,r);q.success(`Se actualizo el Documento con código:  ${s.data.code_number}`);let c=u.procedureList.get().find(m=>m.id===r.procedure_id);return c&&(c=Object.assign(c,{id:c.id,code_number:c.code_number,reference_doc_number:s.data.reference_doc_number,subject:s.data.subject,solicitante:c.solicitante,created_at:c.created_at,updated_at:c.updated_at})),!0}catch(o){return console.log(o),!1}},Kt={key:2,class:"w-full flex items-center justify-between pt-1"},Jt=l("div",null,null,-1),Qt=l("i",{class:"fas fa-plus ml-1 rounded-full"},null,-1),Wt=S({__name:"procedureForm",setup(r){const e=C({description:"",reference_doc_number:""}),o=C([]),s=C(!1),c=C(),m=C(),g=M(()=>u.currentProcedure.get()),k=C(!1),f=C(!1),d=C(),_=async()=>{c.value.validate(async D=>{if(!D){q.error("Por favor, rellene los campos correctamente");return}e.value.user_id=Z.user.get().id,k.value=!0,g.value?await Ht({procedure_id:g.value.id,subject:g.value.subject,description:g.value.description,reference_doc_number:g.value.reference_doc_number,number_of_sheets:g.value.number_of_sheets}):await Bt(e.value),u.isModalOpen.set(!1),e.value={},k.value=!1})},v=async D=>{s.value=!0,await $e(D),s.value=!1,o.value=u.personList.get()},P=()=>{u.isModalOpen.set(!1)},F=()=>{if(!g.value)return;e.value=g.value;const D=u.procedureTypeList.get().find(p=>p.id===g.value.procedure_type_id);D&&(e.value.procedure_type_id=D.id)},U=async()=>{e.value.procedure_type_id&&await Zt(e.value.procedure_type_id)},b=async D=>{f.value=!1,await v(D.numero_documento),e.value.person_id=D.id,d.value.focus()};return J(async()=>{c.value.resetFields(),u.procedureRequirements.set([]),await Yt(),F()}),(D,p)=>{const O=Ot,I=le,h=G,H=ae,Y=Q,T=oe,fe=ke,ge=ie,be=se;return t(f)?(i(),w(O,{key:0,onReturn:p[0]||(p[0]=V=>f.value=!1),onCreate:b})):(i(),w(be,{key:1,class:"w-full bg-gray-100 rounded-lg p-3","label-position":"top",model:t(e),rules:t(Gt),"label-width":"120px",ref_key:"form",ref:c},{default:n(()=>[a(T,{label:"Solicitante",prop:"person_id"},{default:n(()=>[t(g)?(i(),w(Y,{key:1,modelValue:t(e).person_full_name,"onUpdate:modelValue":p[2]||(p[2]=V=>t(e).person_full_name=V),disabled:""},null,8,["modelValue"])):(i(),w(H,{key:0,ref_key:"personIdRef",ref:m,modelValue:t(e).person_id,"onUpdate:modelValue":p[1]||(p[1]=V=>t(e).person_id=V),filterable:"",remote:"","reserve-keyword":"",placeholder:"Ingrese su numero de dni",class:"w-full","remote-method":v,loading:t(s)},{empty:n(()=>[a(I,{value:"",disabled:""},{default:n(()=>[y(" No se encontraron resultados - "),a(h,{link:""},{default:n(()=>[y("crear nuevo registro")]),_:1})]),_:1})]),default:n(()=>[(i(!0),$(N,null,j(t(o),V=>(i(),w(I,{key:V.id,label:V.full_name,value:V.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])),t(g)?A("",!0):(i(),$("div",Kt,[Jt,l("a",{onClick:p[3]||(p[3]=V=>f.value=!0),class:"text-xs text-blue-500 cursor-pointer"},[y(" Crear nuevo registro "),Qt])]))]),_:1}),a(T,{label:"Tramite",prop:"procedure_type_id"},{default:n(()=>[t(g)?(i(),w(Y,{key:1,modelValue:t(e).procedure_type_description,"onUpdate:modelValue":p[5]||(p[5]=V=>t(e).procedure_type_description=V),disabled:""},null,8,["modelValue"])):(i(),w(H,{key:0,modelValue:t(e).procedure_type_id,"onUpdate:modelValue":p[4]||(p[4]=V=>t(e).procedure_type_id=V),class:"w-full",onChange:U,placeholder:"Seleccione un tramite",ref_key:"procedureTypeIdRef",ref:d},{default:n(()=>[(i(!0),$(N,null,j(t(u).procedureTypeList.get(),V=>(i(),w(I,{value:V.id,label:V.description},null,8,["value","label"]))),256))]),_:1},8,["modelValue"]))]),_:1}),t(u).procedureRequirements.get()&&t(u).procedureRequirements.get().length>0?(i(),w(T,{key:0,label:"Requisitos del tramite"},{default:n(()=>[(i(!0),$(N,null,j(t(u).procedureRequirements.get(),V=>(i(),w(fe,{key:V.id,class:"mx-1",size:"small"},{default:n(()=>[y(x(V.description),1)]),_:2},1024))),128))]),_:1})):A("",!0),a(T,{label:"Asunto",prop:"subject"},{default:n(()=>[a(Y,{type:"textarea",modelValue:t(e).subject,"onUpdate:modelValue":p[6]||(p[6]=V=>t(e).subject=V)},null,8,["modelValue"])]),_:1}),a(T,{label:"Observación"},{default:n(()=>[a(Y,{modelValue:t(e).description,"onUpdate:modelValue":p[7]||(p[7]=V=>t(e).description=V),type:"textarea",autosize:{minRows:2,maxRows:4}},null,8,["modelValue"])]),_:1}),a(T,{label:"Referencia"},{default:n(()=>[a(Y,{modelValue:t(e).reference_doc_number,"onUpdate:modelValue":p[8]||(p[8]=V=>t(e).reference_doc_number=V)},null,8,["modelValue"])]),_:1}),a(T,{label:"Número de folios"},{default:n(()=>[a(ge,{modelValue:t(e).number_of_sheets,"onUpdate:modelValue":p[9]||(p[9]=V=>t(e).number_of_sheets=V),min:0,max:100},null,8,["modelValue"])]),_:1}),a(T,{class:"flex items-center mt-10"},{default:n(()=>[a(h,{onClick:P},{default:n(()=>[y("Cancel")]),_:1}),a(h,{loading:t(k),type:"primary",onClick:_},{default:n(()=>[y(x(t(g)?"Actualizar Tramite":"Crear Tramite"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]))}}}),Xt={class:"my-header text-center mb-6"},eo={class:"my-header text-center mb-6"},to={class:"my-header text-center mb-6"},oo=S({__name:"procedureDrawer",setup(r){const e=M(()=>u.currentProcedure.get()),o=M({get:()=>u.isModalOpen.get(),set:m=>u.isModalOpen.set(m)}),s=M({get:()=>u.isModalDerivation.get(),set:m=>u.isModalDerivation.set(m)}),c=M({get:()=>u.isModalFinish.get(),set:m=>u.isModalFinish.set(m)});return(m,g)=>{const k=Wt,f=Ce,d=Tt,_=Ct;return i(),$(N,null,[a(f,{modelValue:t(o),"onUpdate:modelValue":g[0]||(g[0]=v=>z(o)?o.value=v:null),class:"rounded-lg overflow-hidden customDrawer"},{header:n(()=>[l("div",Xt,[l("h1",null,x(t(e)?"Actualizar":"Nuevo")+" Tramite",1)])]),default:n(()=>[t(o)?(i(),w(k,{key:0})):A("",!0)]),_:1},8,["modelValue"]),a(f,{modelValue:t(s),"onUpdate:modelValue":g[1]||(g[1]=v=>z(s)?s.value=v:null),class:"rounded-lg overflow-hidden"},{header:n(()=>[l("div",eo,[l("h1",null,x(t(e)?"Derivar":"")+" Tramite N° "+x(t(e)?t(e).code_number:""),1)])]),default:n(()=>[t(s)?(i(),w(d,{key:0})):A("",!0)]),_:1},8,["modelValue"]),a(f,{modelValue:t(c),"onUpdate:modelValue":g[2]||(g[2]=v=>z(c)?c.value=v:null),class:"rounded-lg overflow-hidden"},{header:n(()=>[l("div",to,[l("h1",null,x(t(e)?"Finalizar":"")+" Tramite N° "+x(t(e)?t(e).code_number:""),1)])]),default:n(()=>[t(c)?(i(),w(_,{key:0})):A("",!0)]),_:1},8,["modelValue"])],64)}}});const re=async r=>{var e;try{const o=(e=R.routes.get().desk.procedures)==null?void 0:e.get_procedure_by_id;if(!o){console.log("No se encontró la ruta para obtener el Documento");return}const s=o.replace("procedure_id",r.toString()),c=await E.get(s);u.currentProcedure.set(c.data)}catch(o){console.log(o)}},so=async r=>{var e;try{const o=(e=R.routes.get().desk.procedures)==null?void 0:e.get_process_tracking_sheet_pdf;if(!o){console.error("route not found");return}const{data:s}=await E.get(o.replace("{procedure_id}",r.toString())),{path:c}=s;window.open(c,"_blank")}catch(o){console.error(o)}},ne=r=>(Ue("data-v-2ed411c5"),r=r(),Ee(),r),lo={class:"height-adapter overflow-auto"},ao={class:"truncate cursor-pointer underline text-blue-500"},no={class:"truncate"},ro={class:"truncate font-semibold"},co=ne(()=>l("i",{class:"fa-solid fa-pen-to-square text-blue-500"},null,-1)),uo=ne(()=>l("i",{class:"fa-sharp fa-solid fa-share-from-square text-blue-500"},null,-1)),io=ne(()=>l("i",{class:"fa-sharp fa-regular fa-circle-xmark text-blue-500"},null,-1)),_o=ne(()=>l("i",{class:"fa-solid fa-download text-blue-500"},null,-1)),po=S({__name:"tableList",setup(r){const e=M(()=>u.tabSelected.get()),o=M(()=>u.procedureList.get()),s=d=>{u.currentProcedure.set(d),u.isOpenTimeline.set(!0)},c=async d=>{u.currentProcedure.set(d),await re(d.id),u.isModalOpen.set(!0)},m=(d,_)=>{u.currentProcedure.set(d);const v=_.getColumnIndex();d&&v==0&&s(d)},g=async d=>{u.currentProcedure.set(d),await re(d.id),u.isModalDerivation.set(!0)},k=async d=>{u.currentProcedure.set(d),await re(d.id),u.isModalFinish.set(!0)},f=async d=>{u.currentProcedure.set(d),await so(d.id)};return(d,_)=>{const v=De,P=Pe,F=G,U=Te;return i(),$("div",lo,[a(U,{data:t(o),onRowClick:m},{default:n(()=>[a(P,{prop:"code_number",label:"N° de tramite"},{default:n(({row:b})=>[a(v,{"popper-class":"text-lg",content:`Ver detalles del tramite ${b.code_number}`,placement:"top"},{default:n(()=>[l("div",ao,x(b.code_number),1)]),_:2},1032,["content"])]),_:1}),a(P,{prop:"solicitante",label:"Solicitante"}),a(P,{prop:"created_at",label:"Fecha de creación"}),a(P,{prop:"subject",label:"Asunto"},{default:n(({row:b})=>[l("div",no,x(b.subject),1)]),_:1}),a(P,{prop:"last_action",label:"Ultima acción"},{default:n(({row:b})=>[l("div",ro,x(b.last_action),1)]),_:1}),a(P,{label:"Acción",class:"w-full bg-red-500"},{default:n(({row:b})=>[t(e)===t(B).started?(i(),w(F,{key:0,size:"small",text:"",onClick:D=>c(b)},{default:n(()=>[a(v,{"popper-class":"text-lg",content:`Editar tramite ${b.code_number}`,placement:"top"},{default:n(()=>[co]),_:2},1032,["content"])]),_:2},1032,["onClick"])):A("",!0),t(e)!==t(B).finished?(i(),w(F,{key:1,text:"",size:"small",onClick:D=>g(b),disabled:b.state},{default:n(()=>[a(v,{"popper-class":"text-lg",content:b.state?`Tramite ${b.code_number} pendiente de aprobación`:`Derivar tramite ${b.code_number}`,placement:"top"},{default:n(()=>[uo]),_:2},1032,["content"])]),_:2},1032,["onClick","disabled"])):A("",!0),t(e)===t(B).in_progress?(i(),w(F,{key:2,size:"small",text:"",onClick:D=>k(b),disabled:b.state},{default:n(()=>[a(v,{"popper-class":"text-lg",content:b.state?`Tramite ${b.code_number} pendiente de aprobación`:`Finalizar tramite ${b.code_number}`,placement:"top"},{default:n(()=>[io]),_:2},1032,["content"])]),_:2},1032,["onClick","disabled"])):A("",!0),a(F,{id:`loadingButton[${b}]`,size:"small",text:"",onClick:D=>f(b)},{default:n(()=>[a(v,{"popper-class":"text-lg",content:"Descargar PDF del tramite",placement:"top"},{default:n(()=>[_o]),_:1})]),_:2},1032,["id","onClick"])]),_:1})]),_:1},8,["data"])])}}});const mo=pe(po,[["__scopeId","data-v-2ed411c5"]]);const fo=r=>{var e;return{tracing_id:r,user_id:(e=Z.user.get())==null?void 0:e.id}},go=async r=>{var e;try{const o=(e=R.routes.get().desk.procedure_tracing)==null?void 0:e.approve_tracing;if(!o)return;await E.post(o,fo(r)),ue(),W(),q.success("Aprobaste la asignación del documento")}catch(o){console.log(o)}},bo={class:"w-full p-2 bg-gray-100 rounded flex flex-col"},vo={class:"flex items-center gap-2"},yo={class:"text-[10px]"},xo={class:"flex"},ho=l("div",{class:"w-5"},null,-1),wo=S({__name:"pendingCard",props:{cardItem:{type:Object,required:!0}},setup(r){const e=r,o=C(!1),s=M(()=>{const m=e.cardItem.user.split(" ");return`${m[0].charAt(0)}${m[m.length-1].charAt(0)}`}),c=async()=>{o.value=!0,await go(e.cardItem.id),o.value=!1};return(m,g)=>{const k=Me,f=G;return i(),$("div",bo,[l("div",vo,[l("div",null,[r.cardItem.image?(i(),w(k,{key:0,size:"small",src:r.cardItem.image},null,8,["src"])):(i(),w(k,{key:1,size:"small"},{default:n(()=>[y(x(t(s)),1)]),_:1}))]),l("div",yo,[l("b",null,x(r.cardItem.user),1),y(" te a asignado un documento el dia "+x(r.cardItem.date)+" a las "+x(r.cardItem.hour),1)])]),l("div",xo,[ho,l("b",null,[a(f,{onClick:c,loading:t(o),text:"",size:"small",class:"text-blue-500"},{default:n(()=>[y("Aprobar")]),_:1},8,["loading"])])])])}}}),Vo={key:0,class:"flex mt-3 bg-yellow-50 p-2 rounded shadow-sm items-center justify-center gap-5 break-normal"},$o=l("i",{class:"fas fa-exclamation-triangle text-2xl text-yellow-500"},null,-1),ko=l("div",{class:"flex flex-col gap-2"},[l("h1",{class:"font-semibold"},"¡Estos documentos necesitan de tu atención! 😎"),l("span",{class:"text-xs text-gray-500"}," Aquí se muestran los documentos asignados a ti ó al area donde trabajas, que aún no han sido aprobados. ")],-1),Co=[$o,ko],Do=l("i",{class:"fas fa-user text-gray-500"},null,-1),Po={key:0},To={key:0,class:"mt-2 w-full cardContent epgScroll"},Uo={class:"flex flex-col"},Eo={class:"flex flex-col mt-5"},Mo=l("i",{class:"fas fa-users text-gray-500"},null,-1),Ro={key:0},Ao={key:0,class:"mt-2 w-full cardContent epgScroll"},Fo={class:"flex flex-col"},No=S({__name:"pendingComponent",setup(r){const e=M(()=>te.tracingsForUser),o=M(()=>te.tracingsForArea),s=C(!0),c=C(!1);return J(async()=>{await ue(),c.value=!0}),(m,g)=>{const k=wo,f=Re;return i(),$("div",{class:K(["h-full relative pending",t(s)?"is-open":"is-closed"])},[t(s)?(i(),$("div",Vo,Co)):A("",!0),l("div",{class:K(["flex flex-col",t(s)?"mt-4":"mt-10"])},[l("h1",{class:K(["text-xs text-gray-500 flex gap-2 items-center",{"flex flex-col ":!t(s)}])},[Do,t(s)?(i(),$("span",Po,"Documentos asignados a ti")):A("",!0),l("span",{class:K(["text-xs px-2 bg-yellow-500 text-white rounded-full",{" animate-pulse":!t(s)&&t(e).length>0}])},x(t(e).length),3)],2),t(s)?(i(),$("div",To,[l("div",Uo,[(i(!0),$(N,null,j(t(e),(d,_)=>(i(),w(k,{class:"border-b border-white",key:_,"card-item":d},null,8,["card-item"]))),128))])])):A("",!0)],2),a(f),l("div",Eo,[l("h1",{class:K(["text-xs text-gray-500 flex items-center gap-2",{"flex flex-col ":!t(s)}])},[Mo,t(s)?(i(),$("span",Ro,"Documentos asignados a tu área")):A("",!0),l("span",{class:K(["text-xs px-2 bg-yellow-500 text-white rounded-full",{" animate-pulse":!t(s)&&t(e).length>0}])},x(t(o).length),3)],2),t(s)?(i(),$("div",Ao,[l("div",Fo,[(i(!0),$(N,null,j(t(o),(d,_)=>(i(),w(k,{class:"border-b border-white",key:_,"card-item":d},null,8,["card-item"]))),128))])])):A("",!0)])],2)}}});const So=async()=>{try{const r=R.routes.get().desk.years_for_procedures,{data:e}=await E.get(r);u.yearsProcedures.set(e)}catch(r){console.log(r)}},jo={class:"flex justify-between gap-2 w-full h-full"},qo={class:"w-max-[350px]"},Io={class:"w-full bg-white shadow-md rounded-lg p-5 flex flex-col gap-5"},Lo=l("section",null,[l("p",{class:"text-3xl font-bold"},"Tramites")],-1),zo={class:"flex flex-col gap-3"},Oo={class:"flex items-center justify-between"},Yo={class:"flex items-center gap-2"},Bo={class:"flex"},Zo=l("div",{class:"flex gap-2"},[l("i",{class:"fa-sharp fa-solid fa-search"}),y(" Buscar")],-1),Go={class:"flex"},Ho=l("div",{class:"flex gap-2"},[l("i",{class:"fa-sharp fa-solid fa-plus"}),y(" Nuevo tramite")],-1),Ko={class:"inline-flex items-center justify-center px-2 py-1 mr-2 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full"},Jo={class:"inline-flex items-center justify-center px-2 py-1 mr-2 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full"},Qo={class:"inline-flex items-center justify-center px-2 py-1 mr-2 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full"},Wo=S({__name:"index",setup(r){const e=C(B.started),o=C(""),s=C(""),c=C([]),m=C(""),g=()=>{u.currentProcedure.set(null),u.isModalOpen.set(!0)},k=()=>{f()},f=async()=>{let _=`${s.value}-${m.value}`;s.value||(_=null),u.filters.set({date:o.value,code_number:_||"",state:e.value}),u.tabSelected.set(e.value),await W()},d=()=>{f()};return J(async()=>{So(),c.value=u.yearsProcedures.get(),m.value=new Date().getFullYear().toString(),f()}),(_,v)=>{const P=No,F=_e,U=le,b=ae,D=Q,p=G,O=mo,I=Fe,h=Ne,H=oo,Y=Vt;return i(),$(N,null,[l("div",jo,[l("div",qo,[a(P,{class:"bg-white rounded-lg shadow-md p-5"})]),l("div",Io,[Lo,l("div",zo,[l("div",Oo,[l("div",Yo,[a(F,{modelValue:t(o),"onUpdate:modelValue":v[0]||(v[0]=T=>z(o)?o.value=T:null),type:"date",placeholder:"Selecciona una fecha",onChange:f,format:"DD/MM/YYYY","value-format":"YYYY-MM-DD"},null,8,["modelValue"]),l("div",Bo,[a(b,{modelValue:t(m),"onUpdate:modelValue":v[1]||(v[1]=T=>z(m)?m.value=T:null),placeholder:"Periodo",onChange:f},{default:n(()=>[(i(!0),$(N,null,j(t(c),T=>(i(),w(U,{key:T,label:T,value:T},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(D,{onInput:d,onKeydown:Ae(f,["enter"]),modelValue:t(s),"onUpdate:modelValue":v[2]||(v[2]=T=>z(s)?s.value=T:null),placeholder:"N° de tramite"},null,8,["onKeydown","modelValue"])]),a(p,{type:"primary",onClick:f},{default:n(()=>[Zo]),_:1})]),l("div",Go,[a(p,{type:"primary",onClick:g},{default:n(()=>[Ho]),_:1})])]),a(h,{modelValue:t(e),"onUpdate:modelValue":v[3]||(v[3]=T=>z(e)?e.value=T:null),onTabChange:k},{default:n(()=>[a(I,{name:t(B).started},{label:n(()=>[l("span",null,[y("Iniciados "),l("div",Ko,x(t(u).procedureCounter.get().started.label),1)])]),default:n(()=>[a(O)]),_:1},8,["name"]),a(I,{name:t(B).in_progress},{label:n(()=>[l("span",null,[y("En proceso "),l("div",Jo,x(t(u).procedureCounter.get().in_progress.label),1)])]),default:n(()=>[a(O)]),_:1},8,["name"]),a(I,{name:t(B).finished},{label:n(()=>[l("span",null,[y("Finalizados "),l("div",Qo,x(t(u).procedureCounter.get().finished.label),1)])]),default:n(()=>[a(O)]),_:1},8,["name"])]),_:1},8,["modelValue"])])])]),a(H),a(Y)],64)}}}),Xo={};function es(r,e){const o=Wo;return i(),w(o)}const ls=pe(Xo,[["render",es]]);export{ls as default};
