import{r as re,c as C,d as j,b as d,e as D,g as o,p as w,t as b,h as s,C as A,a as L,u as S,D as ue,i as k,w as r,f as l,F as N,G as E,H as z,I as _e,J as pe,K as me,k as R,m as P,o as G,j as q,s as Z,v as te,x as B,y as se,L as oe,M as ae,N as fe,O as ge,P as be,Q as ve,R as xe,S as ye,_ as le,B as he,T as Y,U as we,n as ke,V as $e,W as Te,X as Ve}from"./index-87df4a4e.js";/* empty css                     *//* empty css                  */var I=(t=>(t.started="started",t.in_progress="in_progress",t.finished="finished",t))(I||{});const _=re({procedureList:[],isModalOpen:!1,isModalDetails:!1,isModalDerivation:!1,isModalFinish:!1,personList:[],currentProcedure:null,procedureTypeList:[],headquarterList:[],procedureTracingList:[],procedureCounter:{started:{total:0,count:0,label:""},in_progress:{total:0,count:0,label:""},finished:{total:0,count:0,label:""}},yearsProcedures:[],tabSelected:I.started,isOpenTimeline:!1,areaList:[],userAreaList:[],filters:{date:"",code_number:"",state:I.started}}),De={procedureList:{get:()=>_.procedureList,set:t=>_.procedureList=t},isModalOpen:{get:()=>_.isModalOpen,set:t=>_.isModalOpen=t},isModalDetails:{get:()=>_.isModalDetails,set:t=>_.isModalDetails=t},isModalDerivation:{get:()=>_.isModalDerivation,set:t=>_.isModalDerivation=t},isModalFinish:{get:()=>_.isModalFinish,set:t=>_.isModalFinish=t},personList:{get:()=>_.personList,set:t=>_.personList=t},currentProcedure:{get:()=>_.currentProcedure,set:t=>_.currentProcedure=t},procedureTypeList:{get:()=>_.procedureTypeList,set:t=>_.procedureTypeList=t},headquarterList:{get:()=>_.headquarterList,set:t=>_.headquarterList=t},procedureTracingList:{get:()=>_.procedureTracingList,set:t=>_.procedureTracingList=t},procedureCounter:{get:()=>_.procedureCounter,set:t=>_.procedureCounter=t},yearsProcedures:{get:()=>_.yearsProcedures,set:t=>_.yearsProcedures=t},tabSelected:{get:()=>_.tabSelected,set:t=>_.tabSelected=t},isOpenTimeline:{get:()=>_.isOpenTimeline,set:t=>_.isOpenTimeline=t},areaList:{get:()=>_.areaList,set:t=>_.areaList=t},userAreaList:{get:()=>_.userAreaList,set:t=>_.userAreaList=t},filters:{get:()=>_.filters,set:t=>_.filters=t}},c=C(()=>De).value,Pe={class:"w-full text-sm p-2 flex flex-col items-center justify-center"},Ce=o("i",{class:"fas fa-file-alt text-3xl"},null,-1),Le={class:"text-xs"},Se=o("b",null,"Tramite",-1),Fe=o("div",{class:"w-full h-px bg-gray-300"},null,-1),Me={class:"p-2 flex flex-col gap-2"},Ae=o("div",{class:"text-base text-blue-400 font-light"},"Datos del Tramite",-1),Ue={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Oe=o("i",{class:"fas fa-user"},null,-1),Ie={class:"font-semibold"},Ee={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},je=o("i",{class:"fas fa-calendar"},null,-1),ze={class:"font-semibold"},Ne={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Re=o("i",{class:"fas fa-map-marker-alt"},null,-1),qe={class:"font-semibold"},Ye={key:0,class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Be=o("i",{class:"fa-sharp fa-solid fa-check"},null,-1),Ke=o("span",{class:"font-semibold bg-yellow-400 text-white rounded-lg px-2"},"Por confirmar aprobación",-1),Ge=o("div",{class:"w-full border border-dotted"},null,-1),He=o("div",{class:"text-base text-blue-400 font-light"},"Datos del Tramitante",-1),Je={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Qe=o("i",{class:"fas fa-user"},null,-1),We={class:"font-semibold"},Xe={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},Ze=o("i",{class:"fas fa-file"},null,-1),et={class:"font-semibold"},tt={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},st=o("i",{class:"fas fa-file"},null,-1),ot={class:"font-semibold"},at={class:"flex items-center text-xs gap-2 bg-gray-50 px-2 py-1"},nt=o("i",{class:"fas fa-file"},null,-1),rt={class:"font-semibold"},lt=j({__name:"leftCard",setup(t){const e=C(()=>c.currentProcedure.get());return(a,n)=>{var i;return d(),D("div",null,[o("div",Pe,[Ce,o("div",Le,[Se,w(": "),o("span",null,b((i=s(e))==null?void 0:i.code_number),1)])]),Fe,o("div",Me,[Ae,o("div",Ue,[Oe,w("Creado por: "),o("span",Ie,b(s(e).user_name),1)]),o("div",Ee,[je,w("Fecha: "),o("span",ze,b(s(e).created_at),1)]),o("div",Ne,[Re,w("Lugar de creación: "),o("span",qe,b(s(e).headquarter_name),1)]),s(e).state?(d(),D("div",Ye,[Be,w("Estado: "),Ke])):A("",!0),Ge,He,o("div",Je,[Qe,w("Tramitante: "),o("span",We,b(s(e).person_full_name),1)]),o("div",Xe,[Ze,w("Nro. Documento: "),o("span",et,b(s(e).person_document),1)]),o("div",tt,[st,w("Asunto: "),o("span",ot,b(s(e).procedure_type_description),1)]),o("div",at,[nt,w("Nro. Referencia: "),o("span",rt,b(s(e).reference_doc_number),1)])])])}}}),ct=async t=>{var e;try{const a=(e=L.routes.get().desk.procedures)==null?void 0:e.get_procedure_and_tracing_by_id;if(!a)return;const{data:n}=await S.post(a,{procedure_id:t});c.currentProcedure.set(n.procedure),c.procedureTracingList.set(n.procedure_tracings)}catch(a){console.log(a)}},it={class:"flex justify-start gap-2 h-full"},dt={class:"items-center rounded-lg shadow-md w-[60%] h-96 p-2 timelineContent"},ut={class:"p-2 shadow rounded text-xs font-[roboto] border flex flex-col gap-2"},_t={class:"break-normal"},pt={class:"text-[10px]"},mt=j({__name:"procedureTimeline",setup(t){const e=C({get:()=>c.isOpenTimeline.get(),set:n=>c.isOpenTimeline.set(n)});ue(()=>e.value,n=>{n&&ct(c.currentProcedure.get().id)});const a=C(()=>c.procedureTracingList.get());return(n,i)=>{const f=lt,p=me,x=_e,m=pe;return d(),k(m,{modelValue:s(e),"onUpdate:modelValue":i[0]||(i[0]=h=>z(e)?e.value=h:null),"align-center":!0,class:"customDialog"},{default:r(()=>[o("div",it,[l(f,{class:"w-[40%] flex flex-col gap-2"}),o("div",dt,[l(x,null,{default:r(()=>[(d(!0),D(E,null,N(s(a),h=>(d(),k(p,{key:h.id,timestamp:h.date+" "+h.hour,placement:"top",color:"green"},{default:r(()=>[o("div",ut,[o("span",_t,b(h.action_log),1),o("b",pt,"Por: "+b(h.user),1)])]),_:2},1032,["timestamp"]))),128))]),_:1})])])]),_:1},8,["modelValue"])}}});const ce=async()=>{try{const{get_areas:t}=L.routes.get().desk,{data:e,status:a}=await S.get(t);a==200&&c.areaList.set(e)}catch(t){console.log(t)}},ft=()=>c.filters.get(),H=async()=>{var t;try{const e=(t=L.routes.get().desk.procedures)==null?void 0:t.get_procedures;if(!e)return;const{data:a}=await S.get(e,{params:ft()});c.procedureList.set(a.procedures),c.procedureCounter.set(a.counters)}catch(e){console.log(e)}},gt=async t=>{try{const e=L.routes.get().desk.finally_trace_procedure,{status:a}=await S.post(e,t);a==200&&(R.success("Se Finalizo el Tramite correctamente"),H())}catch(e){console.log(e)}},bt=j({__name:"procedureFinish",setup(t){const e=P(!1),a=C(()=>c.currentProcedure.get()),n=P({action:"",assigned_user_id:null});G(async()=>{await ce()});const i=()=>{c.isModalFinish.set(!1)},f=async()=>{var p;e.value=!0,a.value&&(n.value.procedure_id=a.value.id,q.user.get()&&(n.value.user_id=(p=q.user.get())==null?void 0:p.id)),e.value=!1,await gt(n.value),i()};return(p,x)=>{const m=Z,h=te,u=B,y=se;return d(),k(y,{"label-position":"top",model:s(n)},{default:r(()=>[l(h,{label:"Acción"},{default:r(()=>[l(m,{type:"textarea",autosize:{minRows:4,maxRows:6},modelValue:s(n).action,"onUpdate:modelValue":x[0]||(x[0]=$=>s(n).action=$)},null,8,["modelValue"])]),_:1}),l(h,{class:"flex mt-10 items-end"},{default:r(()=>[l(u,{loading:s(e),type:"primary",onClick:f},{default:r(()=>[w(b(s(a)?"Guardar":""),1)]),_:1},8,["loading"]),l(u,{onClick:i},{default:r(()=>[w("Cancel")]),_:1})]),_:1})]),_:1},8,["model"])}}});const vt=async t=>{try{const{get_user_for_area:e}=L.routes.get().desk,{data:a,status:n}=await S.post(e,{area_id:t});n==200&&c.userAreaList.set(a)}catch(e){console.log(e)}},Q=re({tracingsForArea:[],tracingsForUser:[]}),X={get tracingsForArea(){return Q.tracingsForArea},set tracingsForArea(t){Q.tracingsForArea=t},get tracingsForUser(){return Q.tracingsForUser},set tracingsForUser(t){Q.tracingsForUser=t}},ne=async()=>{var t,e;try{const a=(t=L.routes.get().desk.procedure_tracing)==null?void 0:t.get_tracings_to_approved;if(!a){console.log("No se encontró la ruta para obtener los trámites pendientes");return}const n=((e=q.user.get())==null?void 0:e.id)||0,{data:i}=await S.post(a,{user_id:n});X.tracingsForArea=i.tracings_for_area,X.tracingsForUser=i.tracings_for_user}catch(a){console.log(a)}},xt=async t=>{try{const e=L.routes.get().desk.save_derive_procedure,{status:a,data:n}=await S.post(e,t);return a==200?(R.success("Se derivo el Tramite correctamente"),H(),ne(),!0):(R.error(`${n.message}`),!1)}catch(e){return console.log(e),!1}},yt=j({__name:"procedureDerivation",setup(t){const e=P(!1),a=C(()=>c.currentProcedure.get()),n=P({action:"",assigned_user_id:null});G(async()=>{await ce()});const i=x=>{vt(x)},f=()=>{c.isModalDerivation.set(!1)},p=async()=>{var x;e.value=!0,a.value&&(n.value.procedure_id=a.value.id,q.user.get()&&(n.value.user_id=(x=q.user.get())==null?void 0:x.id)),e.value=!1,await xt(n.value),f()};return(x,m)=>{const h=oe,u=ae,y=te,$=Z,g=B,F=se;return d(),k(F,{"label-position":"top",model:s(n)},{default:r(()=>[l(y,{label:"Oficina"},{default:r(()=>[l(u,{class:"w-full",placeholder:"Seleccione una oficina",modelValue:s(n).to_area_id,"onUpdate:modelValue":m[0]||(m[0]=T=>s(n).to_area_id=T),onChange:m[1]||(m[1]=T=>i(s(n).to_area_id))},{default:r(()=>[(d(!0),D(E,null,N(s(c).areaList.get(),T=>(d(),k(h,{key:T.id,label:T.nombre,value:T.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(y,{label:"Acción"},{default:r(()=>[l($,{type:"textarea",autosize:{minRows:4,maxRows:6},modelValue:s(n).action,"onUpdate:modelValue":m[2]||(m[2]=T=>s(n).action=T)},null,8,["modelValue"])]),_:1}),l(y,{label:"Asignar Usuario"},{default:r(()=>[l(u,{class:"w-full",placeholder:"Seleccione Usuario",modelValue:s(n).assigned_user_id,"onUpdate:modelValue":m[3]||(m[3]=T=>s(n).assigned_user_id=T)},{default:r(()=>[(d(!0),D(E,null,N(s(c).userAreaList.get(),T=>(d(),k(h,{key:T.id,label:T.full_name,value:T.user_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(y,{class:"flex mt-10 items-end"},{default:r(()=>[l(g,{loading:s(e),type:"primary",onClick:p},{default:r(()=>[w(b(s(a)?"Derivar":""),1)]),_:1},8,["loading"]),l(g,{onClick:f},{default:r(()=>[w("Cancel")]),_:1})]),_:1})]),_:1},8,["model"])}}});const ht=async t=>{try{const{get_person_list:e}=L.routes.get().person,{data:a,status:n}=await S.post(e,{query:t});n==200&&c.personList.set(a)}catch(e){console.log(e)}},wt=async()=>{try{const{procedure_type:t}=L.routes.get().desk,{data:e,status:a}=await S.get(t.get);a==200&&c.procedureTypeList.set(e)}catch(t){console.log(t)}},kt=async t=>{var e;try{const a=(e=L.routes.get().desk.procedures)==null?void 0:e.save_procedure;if(!a)return;const{data:n,status:i}=await S.post(a,t);i==200&&(R.success(`Se creo el Documento con código:  ${n.code_number}`),H())}catch(a){console.log(a)}},W="blur",$t={person_id:[{required:!0,message:"Por favor seleccione una persona",trigger:W}],procedure_type_id:[{required:!0,message:"Por favor seleccione un tipo de procedimiento",trigger:W}],subject:[{required:!0,message:"Por favor ingrese el asunto",trigger:W},{min:5,message:"El asunto debe tener al menos 5 caracteres",trigger:W}]},Tt=async t=>{var e;try{const a=(e=L.routes.get().desk.procedures)==null?void 0:e.update_procedure;if(!a)return R.error("No se encontró la ruta para actualizar el Documento"),!1;const n=await S.post(a,t);R.success(`Se actualizo el Documento con código:  ${n.data.code_number}`);let i=c.procedureList.get().find(f=>f.id===t.procedure_id);return i&&(i=Object.assign(i,{id:i.id,code_number:i.code_number,reference_doc_number:n.data.reference_doc_number,subject:n.data.subject,solicitante:i.solicitante,created_at:i.created_at,updated_at:i.updated_at})),!0}catch(a){return console.log(a),!1}},Vt=j({__name:"procedureForm",setup(t){const e=P({description:"",reference_doc_number:""}),a=P([]),n=P(!1),i=P(),f=P(),p=C(()=>c.currentProcedure.get()),x=P(!1),m=async()=>{i.value.validate(async $=>{var g;if(!$){R.error("Por favor, rellene los campos correctamente");return}q.user.get()&&(e.value.user_id=(g=q.user.get())==null?void 0:g.id),x.value=!0,p.value?await Tt({procedure_id:p.value.id,subject:p.value.subject,description:p.value.description,reference_doc_number:p.value.reference_doc_number}):await kt(e.value),c.isModalOpen.set(!1),e.value={},x.value=!1})},h=async $=>{n.value=!0,await ht($),n.value=!1,a.value=c.personList.get()},u=()=>{c.isModalOpen.set(!1)},y=()=>{if(!p.value)return;e.value=p.value;const $=c.procedureTypeList.get().find(g=>g.id===p.value.procedure_type_id);$&&(e.value.procedure_type_id=$.id)};return G(async()=>{i.value.resetFields(),await wt(),y()}),($,g)=>{const F=oe,T=B,v=ae,M=Z,O=te,K=se;return d(),k(K,{"label-position":"top",model:s(e),rules:s($t),"label-width":"120px",ref_key:"form",ref:i},{default:r(()=>[l(O,{label:"Solicitante",prop:"person_id"},{default:r(()=>[s(p)?(d(),k(M,{key:1,modelValue:s(e).person_full_name,"onUpdate:modelValue":g[1]||(g[1]=V=>s(e).person_full_name=V),disabled:""},null,8,["modelValue"])):(d(),k(v,{key:0,ref_key:"personIdRef",ref:f,modelValue:s(e).person_id,"onUpdate:modelValue":g[0]||(g[0]=V=>s(e).person_id=V),filterable:"",remote:"","reserve-keyword":"",placeholder:"Ingrese su numero de dni",class:"w-full","remote-method":h,loading:s(n)},{empty:r(()=>[l(F,{value:"",disabled:""},{default:r(()=>[w(" No se encontraron resultados - "),l(T,{link:""},{default:r(()=>[w("crear nuevo")]),_:1})]),_:1})]),default:r(()=>[(d(!0),D(E,null,N(s(a),V=>(d(),k(F,{key:V.id,label:V.full_name,value:V.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]))]),_:1}),l(O,{label:"Tramite",prop:"procedure_type_id"},{default:r(()=>[s(p)?(d(),k(M,{key:1,modelValue:s(e).procedure_type_description,"onUpdate:modelValue":g[3]||(g[3]=V=>s(e).procedure_type_description=V),disabled:""},null,8,["modelValue"])):(d(),k(v,{key:0,modelValue:s(e).procedure_type_id,"onUpdate:modelValue":g[2]||(g[2]=V=>s(e).procedure_type_id=V),class:"w-full",placeholder:"Seleccione un tramite"},{default:r(()=>[(d(!0),D(E,null,N(s(c).procedureTypeList.get(),V=>(d(),k(F,{value:V.id,label:V.description},null,8,["value","label"]))),256))]),_:1},8,["modelValue"]))]),_:1}),l(O,{label:"Asunto",prop:"subject"},{default:r(()=>[l(M,{modelValue:s(e).subject,"onUpdate:modelValue":g[4]||(g[4]=V=>s(e).subject=V)},null,8,["modelValue"])]),_:1}),l(O,{label:"Observación"},{default:r(()=>[l(M,{modelValue:s(e).description,"onUpdate:modelValue":g[5]||(g[5]=V=>s(e).description=V),type:"textarea",autosize:{minRows:2,maxRows:4}},null,8,["modelValue"])]),_:1}),l(O,{label:"Referencia"},{default:r(()=>[l(M,{modelValue:s(e).reference_doc_number,"onUpdate:modelValue":g[6]||(g[6]=V=>s(e).reference_doc_number=V)},null,8,["modelValue"])]),_:1}),l(O,{class:"flex items-center mt-10"},{default:r(()=>[l(T,{loading:s(x),type:"primary",onClick:m},{default:r(()=>[w(b(s(p)?"Actualizar Tramite":"Crear Tramite"),1)]),_:1},8,["loading"]),l(T,{onClick:u},{default:r(()=>[w("Cancel")]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),Dt={class:"my-header text-center mb-6"},Pt={class:"my-header text-center mb-6"},Ct={class:"my-header text-center mb-6"},Lt=j({__name:"procedureDrawer",setup(t){const e=C(()=>c.currentProcedure.get()),a=C({get:()=>c.isModalOpen.get(),set:f=>c.isModalOpen.set(f)}),n=C({get:()=>c.isModalDerivation.get(),set:f=>c.isModalDerivation.set(f)}),i=C({get:()=>c.isModalFinish.get(),set:f=>c.isModalFinish.set(f)});return(f,p)=>{const x=Vt,m=fe,h=yt,u=bt;return d(),D(E,null,[l(m,{modelValue:s(a),"onUpdate:modelValue":p[0]||(p[0]=y=>z(a)?a.value=y:null),class:"rounded-lg customDrawer overflow-hidden"},{header:r(()=>[o("div",Dt,[o("h1",null,b(s(e)?"Actualizar":"Nuevo")+" Tramite",1)])]),default:r(()=>[s(a)?(d(),k(x,{key:0})):A("",!0)]),_:1},8,["modelValue"]),l(m,{modelValue:s(n),"onUpdate:modelValue":p[1]||(p[1]=y=>z(n)?n.value=y:null),class:"rounded-lg customDrawer overflow-hidden"},{header:r(()=>[o("div",Pt,[o("h1",null,b(s(e)?"Derivar":"")+" Tramite N° "+b(s(e)?s(e).code_number:""),1)])]),default:r(()=>[s(n)?(d(),k(h,{key:0})):A("",!0)]),_:1},8,["modelValue"]),l(m,{modelValue:s(i),"onUpdate:modelValue":p[2]||(p[2]=y=>z(i)?i.value=y:null),class:"rounded-lg customDrawer overflow-hidden"},{header:r(()=>[o("div",Ct,[o("h1",null,b(s(e)?"Finalizar":"")+" Tramite N° "+b(s(e)?s(e).code_number:""),1)])]),default:r(()=>[s(i)?(d(),k(u,{key:0})):A("",!0)]),_:1},8,["modelValue"])],64)}}});const ee=async t=>{var e;try{const a=(e=L.routes.get().desk.procedures)==null?void 0:e.get_procedure_by_id;if(!a){console.log("No se encontró la ruta para obtener el Documento");return}const n=a.replace("procedure_id",t.toString()),i=await S.get(n);c.currentProcedure.set(i.data)}catch(a){console.log(a)}},St=async t=>{var e;try{const a=(e=L.routes.get().desk.procedures)==null?void 0:e.get_process_tracking_sheet_pdf;if(!a){console.error("route not found");return}const{data:n}=await S.get(a.replace("{procedure_id}",t.toString())),{path:i}=n;window.open(i,"_blank")}catch(a){console.error(a)}},J=t=>(xe("data-v-8f9b0b2f"),t=t(),ye(),t),Ft={class:"height-adapter overflow-auto"},Mt={class:"truncate cursor-pointer underline text-blue-500"},At={class:"truncate"},Ut={class:"truncate font-semibold"},Ot=J(()=>o("i",{class:"fa-solid fa-timeline text-blue-500"},null,-1)),It=J(()=>o("i",{class:"fa-solid fa-pen-to-square text-blue-500"},null,-1)),Et=J(()=>o("i",{class:"fa-sharp fa-solid fa-share-from-square text-blue-500"},null,-1)),jt=J(()=>o("i",{class:"fa-sharp fa-regular fa-circle-xmark text-blue-500"},null,-1)),zt=J(()=>o("i",{class:"fa-solid fa-download text-blue-500"},null,-1)),Nt=j({__name:"tableList",setup(t){const e=C(()=>c.tabSelected.get()),a=C(()=>c.procedureList.get()),n=P(!1),i=u=>{c.currentProcedure.set(u),c.isOpenTimeline.set(!0)},f=async u=>{c.currentProcedure.set(u),await ee(u.id),c.isModalOpen.set(!0)},p=(u,y)=>{c.currentProcedure.set(u);const $=y.getColumnIndex();u&&$==0&&i(u)},x=async u=>{c.currentProcedure.set(u),await ee(u.id),c.isModalDerivation.set(!0)},m=async u=>{c.currentProcedure.set(u),await ee(u.id),c.isModalFinish.set(!0)},h=async u=>{n.value=!0,c.currentProcedure.set(u),await St(u.id),n.value=!1};return(u,y)=>{const $=ge,g=be,F=B,T=ve;return d(),D("div",Ft,[l(T,{data:s(a),onRowClick:p},{default:r(()=>[l(g,{prop:"code_number",label:"N° de tramite"},{default:r(({row:v})=>[l($,{"popper-class":"text-lg",content:`Ver detalles del tramite ${v.code_number}`,placement:"top"},{default:r(()=>[o("div",Mt,b(v.code_number),1)]),_:2},1032,["content"])]),_:1}),l(g,{prop:"solicitante",label:"Solicitante"}),l(g,{prop:"created_at",label:"Fecha de creación"}),l(g,{prop:"subject",label:"Asunto"},{default:r(({row:v})=>[o("div",At,b(v.subject),1)]),_:1}),l(g,{prop:"last_action",label:"Ultima acción"},{default:r(({row:v})=>[o("div",Ut,b(v.last_action),1)]),_:1}),l(g,{label:"Acción",class:"w-full bg-red-500"},{default:r(({row:v})=>[l(F,{size:"small",text:"",onClick:M=>i(v)},{default:r(()=>[l($,{"popper-class":"text-lg",content:`Ver detalles del tramite ${v.code_number}`,placement:"top"},{default:r(()=>[Ot]),_:2},1032,["content"])]),_:2},1032,["onClick"]),s(e)===s(I).started?(d(),k(F,{key:0,size:"small",text:"",onClick:M=>f(v)},{default:r(()=>[l($,{"popper-class":"text-lg",content:`Editar tramite ${v.code_number}`,placement:"top"},{default:r(()=>[It]),_:2},1032,["content"])]),_:2},1032,["onClick"])):A("",!0),s(e)!==s(I).finished?(d(),k(F,{key:1,text:"",size:"small",onClick:M=>x(v),disabled:v.state},{default:r(()=>[l($,{"popper-class":"text-lg",content:v.state?`Tramite ${v.code_number} pendiente de aprobación`:`Derivar tramite ${v.code_number}`,placement:"top"},{default:r(()=>[Et]),_:2},1032,["content"])]),_:2},1032,["onClick","disabled"])):A("",!0),s(e)===s(I).in_progress?(d(),k(F,{key:2,size:"small",text:"",onClick:M=>m(v),disabled:v.state},{default:r(()=>[l($,{"popper-class":"text-lg",content:v.state?`Tramite ${v.code_number} pendiente de aprobación`:`Finalizar tramite ${v.code_number}`,placement:"top"},{default:r(()=>[jt]),_:2},1032,["content"])]),_:2},1032,["onClick","disabled"])):A("",!0),l(F,{loading:s(n),size:"small",text:"",onClick:M=>h(v)},{default:r(()=>[l($,{"popper-class":"text-lg",content:"Descargar PDF del tramite",placement:"top"},{default:r(()=>[zt]),_:1})]),_:2},1032,["loading","onClick"])]),_:1})]),_:1},8,["data"])])}}});const Rt=le(Nt,[["__scopeId","data-v-8f9b0b2f"]]);const qt=t=>{var e;return{tracing_id:t,user_id:(e=q.user.get())==null?void 0:e.id}},Yt=async t=>{var e;try{const a=(e=L.routes.get().desk.procedure_tracing)==null?void 0:e.approve_tracing;if(!a)return;await S.post(a,qt(t)),ne(),H(),R.success("Aprobaste la asignación del documento")}catch(a){console.log(a)}},Bt={class:"w-full p-2 bg-gray-100 rounded flex flex-col"},Kt={class:"flex items-center gap-2"},Gt={class:"text-[10px]"},Ht={class:"flex"},Jt=o("div",{class:"w-5"},null,-1),Qt=j({__name:"pendingCard",props:{cardItem:{type:Object,required:!0}},setup(t){const e=t,a=P(!1),n=C(()=>{const f=e.cardItem.user.split(" ");return`${f[0].charAt(0)}${f[f.length-1].charAt(0)}`}),i=async()=>{a.value=!0,await Yt(e.cardItem.id),a.value=!1};return(f,p)=>{const x=he,m=B;return d(),D("div",Bt,[o("div",Kt,[o("div",null,[t.cardItem.image?(d(),k(x,{key:0,size:"small",src:t.cardItem.image},null,8,["src"])):(d(),k(x,{key:1,size:"small"},{default:r(()=>[w(b(s(n)),1)]),_:1}))]),o("div",Gt,[o("b",null,b(t.cardItem.user),1),w(" te a asignado un documento el dia "+b(t.cardItem.date)+" a las "+b(t.cardItem.hour),1)])]),o("div",Ht,[Jt,o("b",null,[l(m,{onClick:i,loading:s(a),type:"text",size:"small",class:"text-blue-500"},{default:r(()=>[w("Aprobar")]),_:1},8,["loading"])])])])}}}),Wt={key:0,class:"flex mt-3 bg-yellow-50 p-2 rounded shadow-sm items-center justify-center gap-5 break-normal"},Xt=o("i",{class:"fas fa-exclamation-triangle text-2xl text-yellow-500"},null,-1),Zt=o("div",{class:"flex flex-col gap-2"},[o("h1",{class:"font-semibold"},"¡Estos documentos necesitan de tu atención! 😎"),o("span",{class:"text-xs text-gray-500"}," Aquí se muestran los documentos asignados a ti ó al area donde trabajas, que aún no han sido aprobados o rechazados. ")],-1),es=[Xt,Zt],ts=o("i",{class:"fas fa-user text-gray-500"},null,-1),ss={key:0},os={key:0,class:"mt-2 w-full cardContent epgScroll"},as={class:"flex flex-col"},ns={class:"flex flex-col mt-5"},rs=o("i",{class:"fas fa-users text-gray-500"},null,-1),ls={key:0},cs={key:0,class:"mt-2 w-full cardContent epgScroll"},is={class:"flex flex-col"},ds=j({__name:"pendingComponent",setup(t){const e=C(()=>X.tracingsForUser),a=C(()=>X.tracingsForArea),n=P(!0),i=P(!1);return G(async()=>{await ne(),i.value=!0}),(f,p)=>{const x=Qt,m=we;return d(),D("div",{class:Y(["h-full relative pending",s(n)?"is-open":"is-closed"])},[s(n)?(d(),D("div",Wt,es)):A("",!0),o("div",{class:Y(["flex flex-col",s(n)?"mt-4":"mt-10"])},[o("h1",{class:Y(["text-xs text-gray-500 flex gap-2 items-center",{"flex flex-col ":!s(n)}])},[ts,s(n)?(d(),D("span",ss,"Documentos asignados a ti")):A("",!0),o("span",{class:Y(["text-xs px-2 bg-yellow-500 text-white rounded-full",{" animate-pulse":!s(n)&&s(e).length>0}])},b(s(e).length),3)],2),s(n)?(d(),D("div",os,[o("div",as,[(d(!0),D(E,null,N(s(e),(h,u)=>(d(),k(x,{class:"border-b border-white",key:u,"card-item":h},null,8,["card-item"]))),128))])])):A("",!0)],2),l(m),o("div",ns,[o("h1",{class:Y(["text-xs text-gray-500 flex items-center gap-2",{"flex flex-col ":!s(n)}])},[rs,s(n)?(d(),D("span",ls,"Documentos asignados a tu área")):A("",!0),o("span",{class:Y(["text-xs px-2 bg-yellow-500 text-white rounded-full",{" animate-pulse":!s(n)&&s(e).length>0}])},b(s(a).length),3)],2),s(n)?(d(),D("div",cs,[o("div",is,[(d(!0),D(E,null,N(s(a),(h,u)=>(d(),k(x,{class:"border-b border-white",key:u,"card-item":h},null,8,["card-item"]))),128))])])):A("",!0)])],2)}}});const us=async()=>{try{const t=L.routes.get().desk.years_for_procedures,{data:e}=await S.get(t);c.yearsProcedures.set(e)}catch(t){console.log(t)}},_s={class:"flex justify-between gap-2 w-full h-full"},ps={class:"w-max-[350px]"},ms={class:"w-full bg-white shadow-md rounded-lg p-5 flex flex-col gap-5"},fs=o("section",null,[o("p",{class:"text-3xl font-bold"},"Tramites")],-1),gs={class:"flex flex-col gap-3"},bs={class:"flex items-center justify-between"},vs={class:"flex items-center gap-2"},xs={class:"flex"},ys=o("div",{class:"flex gap-2"},[o("i",{class:"fa-sharp fa-solid fa-search"}),w(" Buscar")],-1),hs={class:"flex"},ws=o("div",{class:"flex gap-2"},[o("i",{class:"fa-sharp fa-solid fa-plus"}),w(" Nuevo tramite")],-1),ks={class:"inline-flex items-center justify-center px-2 py-1 mr-2 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full"},$s={class:"inline-flex items-center justify-center px-2 py-1 mr-2 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full"},Ts={class:"inline-flex items-center justify-center px-2 py-1 mr-2 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full"},Vs=j({__name:"index",setup(t){const e=P(I.started),a=P(""),n=P(""),i=P([]),f=P(""),p=()=>{c.currentProcedure.set(null),c.isModalOpen.set(!0)},x=()=>{m()},m=async()=>{const u=`${n.value}-${f.value}`;c.filters.set({date:a.value,code_number:u,state:e.value}),c.tabSelected.set(e.value),await H()},h=()=>{m()};return G(async()=>{us(),i.value=c.yearsProcedures.get(),f.value=new Date().getFullYear().toString(),m()}),(u,y)=>{const $=ds,g=$e,F=oe,T=ae,v=Z,M=B,O=Rt,K=Ve,V=Te,ie=Lt,de=mt;return d(),D(E,null,[o("div",_s,[o("div",ps,[l($,{class:"bg-white rounded-lg shadow-md p-5"})]),o("div",ms,[fs,o("div",gs,[o("div",bs,[o("div",vs,[l(g,{modelValue:s(a),"onUpdate:modelValue":y[0]||(y[0]=U=>z(a)?a.value=U:null),type:"date",placeholder:"Selecciona una fecha",onChange:m,format:"DD/MM/YYYY","value-format":"YYYY-MM-DD"},null,8,["modelValue"]),o("div",xs,[l(T,{modelValue:s(f),"onUpdate:modelValue":y[1]||(y[1]=U=>z(f)?f.value=U:null),placeholder:"Periodo",onChange:m},{default:r(()=>[(d(!0),D(E,null,N(s(i),U=>(d(),k(F,{key:U,label:U,value:U},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(v,{onInput:h,onKeydown:ke(m,["enter"]),modelValue:s(n),"onUpdate:modelValue":y[2]||(y[2]=U=>z(n)?n.value=U:null),placeholder:"N° de tramite"},null,8,["onKeydown","modelValue"])]),l(M,{type:"primary",onClick:m},{default:r(()=>[ys]),_:1})]),o("div",hs,[l(M,{type:"primary",onClick:p},{default:r(()=>[ws]),_:1})])]),l(V,{modelValue:s(e),"onUpdate:modelValue":y[3]||(y[3]=U=>z(e)?e.value=U:null),onTabChange:x},{default:r(()=>[l(K,{name:s(I).started},{label:r(()=>[o("span",null,[w("Iniciados "),o("div",ks,b(s(c).procedureCounter.get().started.label),1)])]),default:r(()=>[l(O)]),_:1},8,["name"]),l(K,{name:s(I).in_progress},{label:r(()=>[o("span",null,[w("En proceso "),o("div",$s,b(s(c).procedureCounter.get().in_progress.label),1)])]),default:r(()=>[l(O)]),_:1},8,["name"]),l(K,{name:s(I).finished},{label:r(()=>[o("span",null,[w("Finalizados "),o("div",Ts,b(s(c).procedureCounter.get().finished.label),1)])]),default:r(()=>[l(O)]),_:1},8,["name"])]),_:1},8,["modelValue"])])])]),l(ie),l(de)],64)}}}),Ds={};function Ps(t,e){const a=Vs;return d(),k(a)}const Fs=le(Ds,[["render",Ps]]);export{Fs as default};
